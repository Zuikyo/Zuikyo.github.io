<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
    
  
  <link href="https://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet" type="text/css" />







  

<link href="https://cdn.bootcss.com/font-awesome/4.6.2/css/font-awesome.min.css" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="iOS," />





  <link rel="alternate" href="/atom.xml" title="ğŸ¼é»‘è¶…ç†ŠçŒ«zuik's blog" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.1" />






<meta name="description" content="å½“é™æ€åˆ†ææ— æ³•è·å–è¶³å¤Ÿçš„ä¿¡æ¯æ—¶ï¼Œå°±éœ€è¦è¿›è¡ŒåŠ¨æ€åˆ†æï¼Œåœ¨ app è¿è¡Œæ—¶ï¼Œè¿½è¸ªæ–¹æ³•è°ƒç”¨ã€æŸ¥çœ‹å†…å­˜ä¿¡æ¯ã€‚æœ€åæ‰¾åˆ°æƒ³è¦åˆ†æçš„å…³é”®å‡½æ•°ã€‚
è¿™ç¯‡æ–‡ç« åŒ…æ‹¬ï¼š

ç¯å¢ƒæ­å»º
åè°ƒè¯•
åŠ¨æ€è°ƒè¯•çš„æ€è·¯
lldb è°ƒè¯•å‘½ä»¤ä¸è„šæœ¬
cycript é…ç½®ä¸ä½¿ç”¨
frida é…ç½®ä¸ä½¿ç”¨
IDA åŠ¨æ€è°ƒè¯•

ç¯å¢ƒæ­å»ºå®‰è£… openSSHå‚ç…§é™æ€åˆ†æä¸­çš„å®‰è£… openSSHå°ç»“ã€‚
ç”¨ USB è¿›è¡Œ SSH è¿æ¥openSSH é»˜">
<meta property="og:type" content="article">
<meta property="og:title" content="iOSé€†å‘æŒ‡å—ï¼šåŠ¨æ€åˆ†æ">
<meta property="og:url" content="http://zuikyo.github.io/2018/05/10/iOS_reverse_engineering_guide-dynamic_analyzing/index.html">
<meta property="og:site_name" content="ğŸ¼é»‘è¶…ç†ŠçŒ«zuik's blog">
<meta property="og:description" content="å½“é™æ€åˆ†ææ— æ³•è·å–è¶³å¤Ÿçš„ä¿¡æ¯æ—¶ï¼Œå°±éœ€è¦è¿›è¡ŒåŠ¨æ€åˆ†æï¼Œåœ¨ app è¿è¡Œæ—¶ï¼Œè¿½è¸ªæ–¹æ³•è°ƒç”¨ã€æŸ¥çœ‹å†…å­˜ä¿¡æ¯ã€‚æœ€åæ‰¾åˆ°æƒ³è¦åˆ†æçš„å…³é”®å‡½æ•°ã€‚
è¿™ç¯‡æ–‡ç« åŒ…æ‹¬ï¼š

ç¯å¢ƒæ­å»º
åè°ƒè¯•
åŠ¨æ€è°ƒè¯•çš„æ€è·¯
lldb è°ƒè¯•å‘½ä»¤ä¸è„šæœ¬
cycript é…ç½®ä¸ä½¿ç”¨
frida é…ç½®ä¸ä½¿ç”¨
IDA åŠ¨æ€è°ƒè¯•

ç¯å¢ƒæ­å»ºå®‰è£… openSSHå‚ç…§é™æ€åˆ†æä¸­çš„å®‰è£… openSSHå°ç»“ã€‚
ç”¨ USB è¿›è¡Œ SSH è¿æ¥openSSH é»˜">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/1865432-c0b799b77d413f72.png?imageMogr2/auto-orient/">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/1865432-2f4895a27fda69fc.png?imageMogr2/auto-orient/">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/1865432-ddd13d66ff9f3f50.png?imageMogr2/auto-orient/">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/1865432-76abb56844484f22.png?imageMogr2/auto-orient/">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/1865432-e3aead1e90ed638f.png?imageMogr2/auto-orient/">
<meta property="og:updated_time" content="2019-07-15T14:17:29.950Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="iOSé€†å‘æŒ‡å—ï¼šåŠ¨æ€åˆ†æ">
<meta name="twitter:description" content="å½“é™æ€åˆ†ææ— æ³•è·å–è¶³å¤Ÿçš„ä¿¡æ¯æ—¶ï¼Œå°±éœ€è¦è¿›è¡ŒåŠ¨æ€åˆ†æï¼Œåœ¨ app è¿è¡Œæ—¶ï¼Œè¿½è¸ªæ–¹æ³•è°ƒç”¨ã€æŸ¥çœ‹å†…å­˜ä¿¡æ¯ã€‚æœ€åæ‰¾åˆ°æƒ³è¦åˆ†æçš„å…³é”®å‡½æ•°ã€‚
è¿™ç¯‡æ–‡ç« åŒ…æ‹¬ï¼š

ç¯å¢ƒæ­å»º
åè°ƒè¯•
åŠ¨æ€è°ƒè¯•çš„æ€è·¯
lldb è°ƒè¯•å‘½ä»¤ä¸è„šæœ¬
cycript é…ç½®ä¸ä½¿ç”¨
frida é…ç½®ä¸ä½¿ç”¨
IDA åŠ¨æ€è°ƒè¯•

ç¯å¢ƒæ­å»ºå®‰è£… openSSHå‚ç…§é™æ€åˆ†æä¸­çš„å®‰è£… openSSHå°ç»“ã€‚
ç”¨ USB è¿›è¡Œ SSH è¿æ¥openSSH é»˜">
<meta name="twitter:image" content="https://upload-images.jianshu.io/upload_images/1865432-c0b799b77d413f72.png?imageMogr2/auto-orient/">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: 0,
      author: 'åšä¸»'
    }
  };
</script>




  <link rel="canonical" href="http://zuikyo.github.io/2018/05/10/iOS_reverse_engineering_guide-dynamic_analyzing/"/>

  <title> iOSé€†å‘æŒ‡å—ï¼šåŠ¨æ€åˆ†æ | ğŸ¼é»‘è¶…ç†ŠçŒ«zuik's blog </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">ğŸ¼é»‘è¶…ç†ŠçŒ«zuik's blog</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">iOS å¼€å‘ä¿®è¡Œä¹‹è·¯</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            åˆ†ç±»
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            å½’æ¡£
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            æ ‡ç­¾
          </a>
        </li>
      

      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                iOSé€†å‘æŒ‡å—ï¼šåŠ¨æ€åˆ†æ
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">å‘è¡¨äº</span>
            <time itemprop="dateCreated" datetime="2018-05-10T00:15:00+08:00" content="2018-05-10">
              2018-05-10
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp;
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/é€†å‘å·¥ç¨‹/" itemprop="url" rel="index">
                    <span itemprop="name">é€†å‘å·¥ç¨‹</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

          
          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>å½“é™æ€åˆ†ææ— æ³•è·å–è¶³å¤Ÿçš„ä¿¡æ¯æ—¶ï¼Œå°±éœ€è¦è¿›è¡ŒåŠ¨æ€åˆ†æï¼Œåœ¨ app è¿è¡Œæ—¶ï¼Œè¿½è¸ªæ–¹æ³•è°ƒç”¨ã€æŸ¥çœ‹å†…å­˜ä¿¡æ¯ã€‚æœ€åæ‰¾åˆ°æƒ³è¦åˆ†æçš„å…³é”®å‡½æ•°ã€‚</p>
<p>è¿™ç¯‡æ–‡ç« åŒ…æ‹¬ï¼š</p>
<ul>
<li>ç¯å¢ƒæ­å»º</li>
<li>åè°ƒè¯•</li>
<li>åŠ¨æ€è°ƒè¯•çš„æ€è·¯</li>
<li>lldb è°ƒè¯•å‘½ä»¤ä¸è„šæœ¬</li>
<li>cycript é…ç½®ä¸ä½¿ç”¨</li>
<li>frida é…ç½®ä¸ä½¿ç”¨</li>
<li>IDA åŠ¨æ€è°ƒè¯•</li>
</ul>
<h2 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h2><h3 id="å®‰è£…-openSSH"><a href="#å®‰è£…-openSSH" class="headerlink" title="å®‰è£… openSSH"></a>å®‰è£… openSSH</h3><p>å‚ç…§é™æ€åˆ†æä¸­çš„<code>å®‰è£… openSSH</code>å°ç»“ã€‚</p>
<h3 id="ç”¨-USB-è¿›è¡Œ-SSH-è¿æ¥"><a href="#ç”¨-USB-è¿›è¡Œ-SSH-è¿æ¥" class="headerlink" title="ç”¨ USB è¿›è¡Œ SSH è¿æ¥"></a>ç”¨ USB è¿›è¡Œ SSH è¿æ¥</h3><p>openSSH é»˜è®¤æ˜¯ç”¨ wifi è¿æ¥åˆ° iOS è®¾å¤‡çš„ï¼Œä½†æ˜¯è¿™æ ·é€Ÿåº¦æ…¢ï¼Œä¸ç¨³å®šã€‚å› æ­¤å¯ä»¥å®‰è£…<code>usbmuxd</code>ï¼Œç”¨ USB è¿æ¥ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">brew install usbmuxd</div></pre></td></tr></table></figure>
<p>å®‰è£…åå°±å¯ä»¥ç”¨<code>iproxy</code>å·¥å…·ï¼Œå°†è®¾å¤‡ä¸Šçš„ç«¯å£å·æ˜ å°„åˆ°ç”µè„‘ä¸Šçš„æŸä¸€ä¸ªç«¯å£ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">iproxy 2222 22</div></pre></td></tr></table></figure>
<p>ç”¨ USB è¿æ¥è®¾å¤‡åˆ° mac ä¸Šï¼Œä¹‹å‰ openSSH è¿æ¥ iOS çš„å‘½ä»¤æ˜¯<code>ssh root@10.5.53.182</code>ï¼Œç°åœ¨æ”¹æˆ<code>ssh root@localhost -p 2222</code>ã€‚</p>
<h3 id="ä¿®æ”¹-debugserver"><a href="#ä¿®æ”¹-debugserver" class="headerlink" title="ä¿®æ”¹ debugserver"></a>ä¿®æ”¹ debugserver</h3><p>ä½¿ç”¨ lldb è°ƒè¯•éœ€è¦å‡†å¤‡ debugserverã€‚ä½¿ç”¨ OSX ä¸­çš„ lldb è¿œç¨‹è¿æ¥ iOS ä¸Šçš„ debugserverï¼Œç”± debugserver ä½œä¸º lldb å’Œ iOS çš„ä¸­è½¬ï¼Œæ‰§è¡Œå‘½ä»¤å’Œè¿”å›ç»“æœã€‚åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼ŒiOS ä¸Šå¹¶æ²¡æœ‰å®‰è£… debugserverï¼Œåªæœ‰åœ¨è®¾å¤‡è¿æ¥è¿‡ä¸€æ¬¡ Xcodeï¼Œå®‰è£…äº†å¼€å‘è€…æ’ä»¶åï¼Œdebugserver æ‰ä¼šè¢« Xcode å®‰è£…åˆ°iOSçš„<code>/Developer/usr/bin/</code>ç›®å½•ä¸‹ã€‚</p>
<p>åœ¨ iOS 11 è¶Šç‹±ä¹‹å‰ï¼Œéœ€è¦å¯¹ debugserver è¿›è¡Œé‡ç­¾åï¼Œåœ¨ iOS 11 ä¸Šå¯ä»¥ç›´æ¥ä½¿ç”¨<code>/Developer/usr/bin/debugserver</code>ï¼Œæˆ–è€…ç›´æ¥ç”¨ Xcode å¯¹ iOS ä¸Šçš„ app è¿›è¡Œè°ƒè¯•ã€‚iOS 11 ä¹‹å‰ç”¨ Xcode è°ƒè¯•éœ€è¦å¯¹ app è¿›è¡Œé‡ç­¾åï¼Œè€Œ iOS 11 ä¹‹åä¸éœ€è¦é‡ç­¾å app ä¹Ÿèƒ½è°ƒè¯•äº†ã€‚</p>
<p>iOS 11 ä¹‹å‰é‡ç­¾å debugserver æ­¥éª¤ï¼š</p>
<p>1.æ‹·è´ debugserver åˆ°æœ¬åœ°è®¡ç®—æœºä¸­ï¼š<code>scp root@iOSDeviceIP:/Developer/usr/bin/debugserver ~/debugserver</code>ã€‚</p>
<p>2.ç„¶åç”¨ ldid æ·»åŠ æƒé™ã€‚ç”±äº ldid ä¸æ”¯æŒ fat äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ‰€ä»¥è¦ç»™ debugserver ç˜¦èº«ï¼Œé€šè¿‡ lipo æŒ‡å®šè¦æ”¯æŒçš„æŒ‡ä»¤ç±»å‹ï¼Œä¾‹å¦‚ï¼š<code>lipo -thin arm64 ~/debugserver -output ~/debugserver</code>ã€‚</p>
<p>3.ç»™ debugserver æ·»åŠ  task_for_pid æƒé™ï¼Œä¿å­˜ä»¥ä¸‹å†…å®¹ä¸º ent.xml æ–‡ä»¶ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">&lt;!DOCTYPE plist PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&gt;</div><div class="line">&lt;plist version=&quot;1.0&quot;&gt;</div><div class="line">&lt;dict&gt;</div><div class="line">        &lt;key&gt;com.apple.springboard.debugapplications&lt;/key&gt;</div><div class="line">        &lt;true/&gt;</div><div class="line">        &lt;key&gt;get-task-allow&lt;/key&gt;</div><div class="line">        &lt;true/&gt;</div><div class="line">        &lt;key&gt;task_for_pid-allow&lt;/key&gt;</div><div class="line">        &lt;true/&gt;</div><div class="line">        &lt;key&gt;run-unsigned-code&lt;/key&gt;</div><div class="line">        &lt;true/&gt;</div><div class="line">&lt;/dict&gt;</div><div class="line">&lt;/plist&gt;</div></pre></td></tr></table></figure>
<p>ç„¶åæ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ·»åŠ æƒé™ï¼š<code>ldid -Sent.xml debugserver</code></p>
<p>4.ç»™ debugserver é‡æ–°ç­¾åï¼Œä¿å­˜ä»¥ä¸‹å†…å®¹ä¸º entitlements.plist æ–‡ä»¶ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</div><div class="line"> &lt;!DOCTYPE plist PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/ PropertyList-1.0.dtd&quot;&gt;</div><div class="line"> &lt;plist version=&quot;1.0&quot;&gt;</div><div class="line"> &lt;dict&gt;</div><div class="line"> &lt;key&gt;com.apple.springboard.debugapplications&lt;/key&gt;</div><div class="line">     &lt;true/&gt;</div><div class="line">     &lt;key&gt;run-unsigned-code&lt;/key&gt;</div><div class="line">     &lt;true/&gt;</div><div class="line">     &lt;key&gt;get-task-allow&lt;/key&gt;</div><div class="line">     &lt;true/&gt;</div><div class="line">     &lt;key&gt;task_for_pid-allow&lt;/key&gt;</div><div class="line">     &lt;true/&gt;</div><div class="line"> &lt;/dict&gt; </div><div class="line"> &lt;/plist&gt;</div></pre></td></tr></table></figure>
<p>ç„¶åè¿è¡Œä»¥ä¸‹å‘½ä»¤ç»™çš„ debugserver ç­¾åï¼š<code>codesign -s - --entitlements entitlements.plist -f debugserver</code></p>
<p>5.é‡æ–°æ‹·è´ debugserver å›æ‰‹æœºä¸­ï¼š<code>scp ~/debugserver root@iOSDeviceIP:/usr/bin/debugserver</code></p>
<p>6.ç¬¬ä¸€æ¬¡ä½¿ç”¨ debugserver æ—¶éœ€è¦ä¸ºå…¶æ·»åŠ å¯æ‰§è¡Œæƒé™ï¼š<code>chmod +x /usr/bin/debugserver</code></p>
<h2 id="è¿æ¥åˆ°æŒ‡å®šè¿›ç¨‹è¿›è¡Œè°ƒè¯•"><a href="#è¿æ¥åˆ°æŒ‡å®šè¿›ç¨‹è¿›è¡Œè°ƒè¯•" class="headerlink" title="è¿æ¥åˆ°æŒ‡å®šè¿›ç¨‹è¿›è¡Œè°ƒè¯•"></a>è¿æ¥åˆ°æŒ‡å®šè¿›ç¨‹è¿›è¡Œè°ƒè¯•</h2><p>å‡†å¤‡å¥½ debugserver åï¼Œå°±å¯ä»¥è°ƒè¯•ä»»æ„ç¬¬ä¸‰æ–¹ app äº†ã€‚</p>
<ol>
<li><p>SSH åˆ° iOSï¼Œä½¿ç”¨ debugserver æ¥ attach ä¸€ä¸ªè¿›ç¨‹ï¼Œè¦æŸ¥çœ‹å½“å‰æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ï¼Œä½¿ç”¨<code>ps -e</code>å‘½ä»¤ã€‚æ¯”å¦‚æˆ‘ä»¬è¦ attach çš„è¿›ç¨‹å·ä¸º 693ï¼Œæˆ‘ä»¬å¯ä»¥è¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼š<code>debugserver *:1234 -a 693</code></p>
</li>
<li><p>iOS 11 ä¸Š<code>debugserver *:1234</code>ä¸­çš„<code>*:1234</code>è¦æ›¿æ¢æˆ<code>localhost:1234</code>ã€‚å¦‚æœç”¨çš„æ˜¯ Electra è¶Šç‹±ï¼Œå‘½ä»¤å˜æˆ<code>/Developer/usr/bin/debugserver localhost:1234 -a 693</code>ï¼Œå¦‚æœç”¨çš„æ˜¯<a href="https://www.abcydia.com/read-16031.html" target="_blank" rel="external">unc0ver</a>è¶Šç‹±ï¼Œåˆ™æ˜¯<code>debugserver localhost:1234 -a 693</code>ã€‚åŒç†ï¼Œä¸‹æ–‡ä¸­çš„å¯¹åº”å‘½ä»¤ä¹Ÿè¦ç›¸åº”çš„æ›¿æ¢</p>
</li>
<li><p>å¦‚æœè¦ç”¨ debugserver å¯åŠ¨ appï¼Œè€Œä¸æ˜¯é™„åŠ åˆ°å·²ç»å¯åŠ¨çš„ appï¼Œåˆ™ä½¿ç”¨<code>debugserver *:1234 &lt;appäºŒè¿›åˆ¶æ–‡ä»¶è·¯å¾„&gt;</code>ï¼Œä¾‹å¦‚<code>debugserver *:1234 /var/containers/Bundle/Application/107F3307-2900-4720-B9BA-0C7792D89DF2/APP_TO_DEBUG.app/APP_TO_DEBUG</code></p>
</li>
<li><p>Mac ç«¯æ‰“å¼€ç»ˆç«¯ï¼Œè¾“å…¥ lldbï¼Œå›è½¦ï¼Œè¿›å…¥ lldb ç•Œé¢ï¼Œä½¿ç”¨<code>process connect</code>å‘½ä»¤è¿æ¥å®¢æˆ·ç«¯ã€‚<br>ç”¨ WiFi è¿æ¥åˆ° iOS è®¾å¤‡æ—¶ï¼š<code>process connect connect://iOSDeviceIP:1234</code>ã€‚</p>
<p>å¦‚æœè¦ç”¨ usbmux è¿æ¥ï¼Œåˆ™å…ˆä½¿ç”¨<code>iproxy 1234 1234</code>è¿›è¡Œä¸€æ¬¡ç«¯å£è½¬å‘ï¼Œå†ä½¿ç”¨<code>process connect connect://localhost:1234</code>ï¼Œå³å¯ç”¨ USB è¿æ¥åˆ° iOS è®¾å¤‡ã€‚</p>
</li>
</ol>
<p>å›è½¦åéœ€è¦ç­‰å¾…å‡ åˆ†é’Ÿï¼Œæ—¶é—´æœ‰ç‚¹ä¹…ã€‚</p>
<p>è¿æ¥æˆåŠŸåï¼Œå³å¯ç”¨ lldb å‘½ä»¤è¿›è¡Œè°ƒè¯•ã€‚</p>
<h2 id="åè°ƒè¯•"><a href="#åè°ƒè¯•" class="headerlink" title="åè°ƒè¯•"></a>åè°ƒè¯•</h2><p>æœ‰äº› app ä½¿ç”¨äº†åè°ƒè¯•åŠŸèƒ½ï¼Œç¦æ­¢äº†åŠ¨æ€è°ƒè¯•ã€‚</p>
<p>ç³»ç»Ÿæä¾›äº†ç¦æ­¢è°ƒè¯•ä¾é™„çš„æ¥å£ï¼Œå¯ä»¥é€šè¿‡<code>ptrace</code> <code>syscall</code> <code>svcæŒ‡ä»¤</code>è°ƒç”¨ï¼Œç¦æ­¢è°ƒè¯•ã€‚ä¹Ÿå¯ä»¥é€šè¿‡<code>sysctlæ£€æŸ¥ ptrace</code>  <code>isatty æˆ–è€… ioctl æ£€æŸ¥ç»ˆç«¯</code> <code>task_get_exception_portsè·å–å¼‚å¸¸ç«¯å£</code>ç­‰æ–¹å¼æ£€æŸ¥æ˜¯å¦æ­£åœ¨è¢«è°ƒè¯•ï¼Œä¹‹åå†è®© app å´©æºƒã€‚</p>
<p>å¯ä»¥å‚è€ƒ<a href="http://iosre.com/t/topic/8179" target="_blank" rel="external">å…³äºåè°ƒè¯•&amp;ååè°ƒè¯•é‚£äº›äº‹</a>ã€<a href="http://bbs.iosre.com/t/topic/9351" target="_blank" rel="external">åè°ƒè¯•ä¸ç»•è¿‡çš„å¥‡æ·«æŠ€å·§</a>ã€‚</p>
<p>å¦‚æœä½ å‘ç° app ä¸€è°ƒè¯•å°±é—ªé€€ï¼Œå¤šåŠå°±æ˜¯æœ‰åè°ƒè¯•æœºåˆ¶ã€‚</p>
<p>ä¸ºéªŒè¯æ˜¯å¦è°ƒç”¨äº† ptrace å¯ä»¥ç”¨ <code>debugserver -x backboard *:1234 binaryPath</code> å¯åŠ¨ appï¼Œç„¶åä¸‹ç¬¦å·æ–­ç‚¹ <code>b ptrace</code>ï¼Œ<code>c</code> ä¹‹åçœ‹ ptrace ç¬¬ä¸€è¡Œä»£ç çš„ä½ç½®ï¼Œç„¶å <code>p $lr</code> æ‰¾åˆ°å‡½æ•°è¿”å›åœ°å€ï¼Œå†æ ¹æ® <code>image list -o -f</code> çš„ASLRåç§»ï¼Œè®¡ç®—å‡ºåŸå§‹åœ°å€ã€‚æœ€ååœ¨ IDA ä¸­æ‰¾åˆ°è°ƒç”¨ptraceçš„ä»£ç ï¼Œåˆ†æå¦‚ä½•è°ƒç”¨çš„ptraceã€‚å…¶ä»–çš„åè°ƒè¯•ç±»ä¼¼ï¼Œå‚è€ƒä¸Šé¢çš„æ–‡ç« ã€‚</p>
<h2 id="å¸¸ç”¨çš„åŠ¨æ€è°ƒè¯•æ–¹æ³•"><a href="#å¸¸ç”¨çš„åŠ¨æ€è°ƒè¯•æ–¹æ³•" class="headerlink" title="å¸¸ç”¨çš„åŠ¨æ€è°ƒè¯•æ–¹æ³•"></a>å¸¸ç”¨çš„åŠ¨æ€è°ƒè¯•æ–¹æ³•</h2><h3 id="æ–­ç‚¹"><a href="#æ–­ç‚¹" class="headerlink" title="æ–­ç‚¹"></a>æ–­ç‚¹</h3><p>ä½¿ç”¨lldbçš„<code>br s -a [åœ°å€]</code>å‘½ä»¤ï¼Œåœ¨æŒ‡å®šåœ°å€å¤„ä¸‹æ–­ç‚¹ã€‚ä½†æ˜¯åŠ¨æ€è°ƒè¯•æ—¶ï¼Œæ— æ³•å‡†ç¡®åœ°æ‰¾åˆ°éœ€è¦æ–­ç‚¹çš„åœ°å€ã€‚å¯ä»¥å…ˆé™æ€åˆ†æ app çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ‰¾åˆ°éœ€è¦ç ”ç©¶çš„æ–¹æ³•ï¼Œå†åœ¨æ–¹æ³•å¤„ä¸‹æ–­ç‚¹ã€‚</p>
<h3 id="æ ¹æ®äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ–¹æ³•çš„åœ°å€ï¼Œæ‰¾åˆ°éœ€è¦æ–­ç‚¹çš„åœ°å€"><a href="#æ ¹æ®äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ–¹æ³•çš„åœ°å€ï¼Œæ‰¾åˆ°éœ€è¦æ–­ç‚¹çš„åœ°å€" class="headerlink" title="æ ¹æ®äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ–¹æ³•çš„åœ°å€ï¼Œæ‰¾åˆ°éœ€è¦æ–­ç‚¹çš„åœ°å€"></a>æ ¹æ®äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ–¹æ³•çš„åœ°å€ï¼Œæ‰¾åˆ°éœ€è¦æ–­ç‚¹çš„åœ°å€</h3><p>app åŠ è½½åˆ°å†…å­˜é‡Œæ—¶ï¼Œæœ‰ä¸€ä¸ªåç§»ï¼š</p>
<p>è¿è¡Œæ—¶çš„åœ°å€ = äºŒè¿›åˆ¶æ–‡ä»¶ä¸­çš„ç›¸å¯¹åœ°å€ + åç§»é‡</p>
<p>ä½¿ç”¨<code>image list</code>åˆ—å‡ºæ‰€æœ‰åŠ è½½çš„æ¨¡å—ï¼ŒæŸ¥çœ‹åç§»é‡ï¼Œæ‰¾åˆ°ç¬¬ä¸€è¡Œï¼š</p>
<p><code>(lldb) image list 
[0] 7A6179DA-8D91-315A-8BD2-546A54648D37 0x00000001000bc000 /Applications/APP_TO_DEBUG.app/APP_TO_DEBUG</code></p>
<p>å…¶ä¸­çš„<code>0x00000001000bc000</code>å°±æ˜¯åŠ è½½çš„åŸºå€ï¼Œåç§»é‡å°±æ˜¯<code>0x1000bc000</code>ã€‚</p>
<p>ä¾‹å¦‚ï¼Œéœ€è¦åˆ†æ<code>-[CLoginController keyboardWillShow]</code>æ–¹æ³•ï¼Œæ–¹æ³•åœ¨äºŒè¿›åˆ¶æ–‡ä»¶ä¸­çš„åœ°å€ä¸º<code>0x0000000100723bcc</code>ï¼š<br><img src="https://upload-images.jianshu.io/upload_images/1865432-c0b799b77d413f72.png?imageMogr2/auto-orient/" alt="hopper6"></p>
<p>è€Œè¿™ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶çš„åŸºå€ä¸º<code>0x100000000</code>ï¼š<br><img src="https://upload-images.jianshu.io/upload_images/1865432-2f4895a27fda69fc.png?imageMogr2/auto-orient/" alt="hopper7"></p>
<p>æ‰€ä»¥æ­¤å‡½æ•°åœ¨æ–‡ä»¶ä¸­çš„åç§»é‡æ˜¯<code>0x0000000100723bcc</code> - <code>0x100000000</code> = <code>0x723bcc</code>ã€‚å› æ­¤å½“å‰å†…å­˜ä¸­çš„è¿è¡Œæ—¶åœ°å€æ˜¯<code>0x1000bc000</code> + <code>0x723bcc</code> = <code>0x1007dfbcc</code>ã€‚</p>
<h3 id="åæ±‡ç¼–æŒ‡å®šåœ°å€"><a href="#åæ±‡ç¼–æŒ‡å®šåœ°å€" class="headerlink" title="åæ±‡ç¼–æŒ‡å®šåœ°å€"></a>åæ±‡ç¼–æŒ‡å®šåœ°å€</h3><p>æ‰¾åˆ°åœ°å€åï¼Œå¯ä»¥ä½¿ç”¨<code>di --start-address &lt;address&gt; -count 10</code>å‘½ä»¤æ¥åæ±‡ç¼–æ‰¾åˆ°çš„åœ°å€ï¼Œå¦‚æœåæ±‡ç¼–ç»“æœå’Œé™æ€åˆ†æä¸­çš„æ±‡ç¼–ä»£ç ä¸€è‡´ï¼Œè¯´æ˜æ‰¾åˆ°çš„æ˜¯æ­£ç¡®çš„:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">(lldb) di --start-address 0x1007dfbcc -c 10</div><div class="line">DuoYiIMOrig`-[CLoginController keyboardWillShow:]:</div><div class="line">0x1007dfbcc &lt;+0&gt;:  stp    d11, d10, [sp, #-0x80]!</div><div class="line">0x1007dfbd0 &lt;+4&gt;:  stp    d9, d8, [sp, #0x10]</div><div class="line">0x1007dfbd4 &lt;+8&gt;:  stp    x28, x27, [sp, #0x20]</div><div class="line">0x1007dfbd8 &lt;+12&gt;: stp    x26, x25, [sp, #0x30]</div><div class="line">0x1007dfbdc &lt;+16&gt;: stp    x24, x23, [sp, #0x40]</div><div class="line">0x1007dfbe0 &lt;+20&gt;: stp    x22, x21, [sp, #0x50]</div><div class="line">0x1007dfbe4 &lt;+24&gt;: stp    x20, x19, [sp, #0x60]</div><div class="line">0x1007dfbe8 &lt;+28&gt;: stp    x29, x30, [sp, #0x70]</div><div class="line">0x1007dfbec &lt;+32&gt;: add    x29, sp, #0x70            ; =0x70 </div><div class="line">0x1007dfbf0 &lt;+36&gt;: sub    sp, sp, #0x40             ; =0x40</div></pre></td></tr></table></figure>
<p>å’Œä¸Šé¢ hooper ä¸­çš„æ±‡ç¼–ä»£ç æ¯”è¾ƒï¼Œå¯ä»¥çœ‹åˆ°æ˜¯ä¸€è‡´çš„ã€‚</p>
<p>åœ¨32ä½è®¾å¤‡ä¸Šï¼Œå¯èƒ½ä¼šå‡ºç°åæ±‡ç¼–å‡ºæ¥çš„æ˜¯ arm æŒ‡ä»¤é›†ï¼Œå‡ºç°å¾ˆå¤š<code>unknown opcode</code>çš„æŒ‡ä»¤ï¼Œå’Œ hopper ä¸­æ˜¾ç¤ºçš„ä¸ä¸€è‡´ã€‚å¯ä»¥åŠ ä¸Š<code>-A thumbv7</code>æ˜¾ç¤º thumb æŒ‡ä»¤é›†çš„åæ±‡ç¼–ç»“æœï¼š<code>di --start-address 0x1007dfbcc -c 10 -A thumbv7</code>ã€‚</p>
<p>å†ç”¨<code>br set -a 0x1007dfbcc</code>æ‰“æ–­ç‚¹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">(lldb) br set -a 0x1007dfbcc</div><div class="line">Breakpoint 1: where = DuoYiIMOrig`-[CLoginController keyboardWillShow:] at CLoginController.m:550, address = 0x00000001007dfbcc</div></pre></td></tr></table></figure>
<h3 id="æŸ¥çœ‹å¯„å­˜å™¨çš„å€¼"><a href="#æŸ¥çœ‹å¯„å­˜å™¨çš„å€¼" class="headerlink" title="æŸ¥çœ‹å¯„å­˜å™¨çš„å€¼"></a>æŸ¥çœ‹å¯„å­˜å™¨çš„å€¼</h3><p>å½“è§¦å‘äº†æ–­ç‚¹åï¼Œå¯ä»¥ç”¨<code>register read</code>æŸ¥çœ‹å½“å‰å¯„å­˜å™¨çš„å€¼ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line">Process 1252 stopped</div><div class="line">* thread #1, queue = &apos;com.apple.main-thread&apos;, stop reason = breakpoint 1.1</div><div class="line">    frame #0: 0x00000001007dfbcc DuoYiIMOrig`-[CLoginController keyboardWillShow:](self=0x0000000123e492f0, _cmd=&quot;keyboardWillShow:&quot;, aNotification=@&quot;UIKeyboardWillShowNotification&quot;) at CLoginController.m:550 [opt]</div><div class="line">    </div><div class="line">(lldb) register read </div><div class="line">General Purpose Registers:</div><div class="line">        x0 = 0x0000000123e492f0</div><div class="line">        x1 = 0x0000000191ad138c</div><div class="line">        x2 = 0x0000000125a81580</div><div class="line">        x3 = 0x00000001a2d26a50  CoreFoundation`__block_literal_global</div><div class="line">        x4 = 0x0000000000000002</div><div class="line">        x5 = 0x0000000000000001</div><div class="line">        x6 = 0x0000000000000000</div><div class="line">        x7 = 0x0000000000000000</div><div class="line">        x8 = 0x0000000125a81580</div><div class="line">        x9 = 0x0000000191ad138c</div><div class="line">       x10 = 0x000000012407f400</div><div class="line">       x11 = 0x0000008a000000ff</div><div class="line">       x12 = 0x000000012407fcc0</div><div class="line">       x13 = 0x000005a1011f1c65</div><div class="line">       x14 = 0x000000000022a802</div><div class="line">       x15 = 0x000000000000358f</div><div class="line">       x16 = 0x00000001011f1c60  (void *)0x000001a1011f1c89</div><div class="line">       x17 = 0x00000001007dfbcc  DuoYiIMOrig`-[CLoginController keyboardWillShow:] at CLoginController.m:550</div><div class="line">       x18 = 0x0000000000000000</div><div class="line">       x19 = 0x0000000125a81580</div><div class="line">       x20 = 0x0000000123da3cb0</div><div class="line">       x21 = 0x0000000000000000</div><div class="line">       x22 = 0x0000000000000000</div><div class="line">       x23 = 0x00000001a8cae000  CoreFoundation`_CFXNotificationPost.samples + 352</div><div class="line">       x24 = 0x00000001a8cae000  CoreFoundation`_CFXNotificationPost.samples + 352</div><div class="line">       x25 = 0x0000000000000000</div><div class="line">       x26 = 0x000000010b651440</div><div class="line">       x27 = 0x00000001a8ca9ef8  __kCFNull</div><div class="line">       x28 = 0x0000000000000001</div><div class="line">        fp = 0x000000016fd3ffe0</div><div class="line">        lr = 0x0000000183be2b10  CoreFoundation`__CFNOTIFICATIONCENTER_IS_CALLING_OUT_TO_AN_OBSERVER__ + 20</div><div class="line">        sp = 0x000000016fd3ffe0</div><div class="line">        pc = 0x00000001007dfbcc  DuoYiIMOrig`-[CLoginController keyboardWillShow:] at CLoginController.m:550</div><div class="line">      cpsr = 0x60000000</div><div class="line"></div><div class="line">(lldb) po 0x0000000123e492f0</div><div class="line">&lt;CLoginController: 0x123e492f0&gt;</div></pre></td></tr></table></figure>
<p>å¦‚æœMacä¸Šå®‰è£…äº†<a href="https://github.com/facebook/chisel" target="_blank" rel="external">chisel</a>ï¼Œè¿˜å¯ä»¥ç”¨<code>pinternals</code>éå†å‡ºå¯¹è±¡çš„å®ä¾‹å˜é‡ã€‚æˆ–è€…è°ƒç”¨ç§æœ‰æ–¹æ³•<code>_ivarDescription</code>æ‰“å°å®ä¾‹å˜é‡ï¼š<code>po [0x0000000123e492f0 _ivarDescription]</code>ã€‚</p>
<h3 id="æŸ¥çœ‹è°ƒç”¨å †æ ˆ"><a href="#æŸ¥çœ‹è°ƒç”¨å †æ ˆ" class="headerlink" title="æŸ¥çœ‹è°ƒç”¨å †æ ˆ"></a>æŸ¥çœ‹è°ƒç”¨å †æ ˆ</h3><p>ç”¨<code>thread backtrace</code>æŸ¥çœ‹è°ƒç”¨å †æ ˆï¼Œç¼©å†™ä¸º<code>bt</code>ã€‚<code>thread backtrace -e true</code>å¯ä»¥æ˜¾ç¤ºçº¿ç¨‹åµŒå¥—çš„å †æ ˆã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line">(lldb) bt</div><div class="line">* thread #1, queue = &apos;com.apple.main-thread&apos;, stop reason = breakpoint 1.1</div><div class="line">  * frame #0: 0x00000001007dfbcc DuoYiIMOrig`-[CLoginController keyboardWillShow:](self=0x0000000123e492f0, _cmd=&quot;keyboardWillShow:&quot;, aNotification=@&quot;UIKeyboardWillShowNotification&quot;) at CLoginController.m:550 [opt]</div><div class="line">    frame #1: 0x0000000183be2214 CoreFoundation`_CFXRegistrationPost + 400</div><div class="line">    frame #2: 0x0000000183be1f90 CoreFoundation`___CFXNotificationPost_block_invoke + 60</div><div class="line">    frame #3: 0x0000000183c51b8c CoreFoundation`-[_CFXNotificationRegistrar find:object:observer:enumerator:] + 1504</div><div class="line">    frame #4: 0x0000000183b23e64 CoreFoundation`_CFXNotificationPost + 376</div><div class="line">    frame #5: 0x0000000184658e0c Foundation`-[NSNotificationCenter postNotificationName:object:userInfo:] + 68</div><div class="line">    frame #6: 0x000000018a4cbb40 UIKit`-[UIInputWindowController postStartNotifications:withInfo:] + 400</div><div class="line">    frame #7: 0x000000018a4cdcf0 UIKit`__77-[UIInputWindowController moveFromPlacement:toPlacement:starting:completion:]_block_invoke.907 + 388</div><div class="line">    frame #8: 0x0000000189b2d0f0 UIKit`+[UIView(UIViewAnimationWithBlocks) _setupAnimationWithDuration:delay:view:options:factory:animations:start:animationStateGenerator:completion:] + 636</div><div class="line">    frame #9: 0x0000000189bfe52c UIKit`+[UIView(UIViewAnimationWithBlocks) _animateWithDuration:delay:options:animations:start:completion:] + 128</div><div class="line">    frame #10: 0x000000018a4cd76c UIKit`-[UIInputWindowController moveFromPlacement:toPlacement:starting:completion:] + 1368</div><div class="line">    frame #11: 0x000000018a4d4268 UIKit`-[UIInputWindowController setInputViewSet:] + 1444</div><div class="line">    frame #12: 0x000000018a4cce38 UIKit`-[UIInputWindowController performOperations:withAnimationStyle:] + 56</div><div class="line">    frame #13: 0x0000000189bbe278 UIKit`-[UIPeripheralHost(UIKitInternal) setInputViews:animationStyle:] + 1276</div><div class="line">    frame #14: 0x0000000189b1da78 UIKit`-[UIResponder(UIResponderInputViewAdditions) reloadInputViews] + 80</div><div class="line">    frame #15: 0x0000000189b7bb4c UIKit`-[UIResponder becomeFirstResponder] + 600</div><div class="line">    frame #16: 0x0000000189b7bebc UIKit`-[UIView(Hierarchy) becomeFirstResponder] + 148</div><div class="line">    frame #17: 0x0000000189bfe0b4 UIKit`-[UITextField becomeFirstResponder] + 60</div><div class="line">    frame #18: 0x0000000189ca5128 UIKit`-[UITextInteractionAssistant(UITextInteractionAssistant_Internal) setFirstResponderIfNecessary] + 192</div><div class="line">    frame #19: 0x0000000189ca4630 UIKit`-[UITextInteractionAssistant(UITextInteractionAssistant_Internal) oneFingerTap:] + 3024</div><div class="line">    frame #20: 0x000000018a0bff80 UIKit`-[UIGestureRecognizerTarget _sendActionWithGestureRecognizer:] + 64</div><div class="line">    frame #21: 0x000000018a0c3688 UIKit`_UIGestureRecognizerSendTargetActions + 124</div><div class="line">    frame #22: 0x0000000189c8a73c UIKit`_UIGestureRecognizerSendActions + 260</div><div class="line">    frame #23: 0x0000000189b290f0 UIKit`-[UIGestureRecognizer _updateGestureWithEvent:buttonEvent:] + 764</div><div class="line">    frame #24: 0x000000018a0b3680 UIKit`_UIGestureEnvironmentUpdate + 1100</div><div class="line">    frame #25: 0x000000018a0b31e0 UIKit`-[UIGestureEnvironment _deliverEvent:toGestureRecognizers:usingBlock:] + 408</div><div class="line">    frame #26: 0x000000018a0b249c UIKit`-[UIGestureEnvironment _updateGesturesForEvent:window:] + 268</div><div class="line">    frame #27: 0x0000000189b2730c UIKit`-[UIWindow sendEvent:] + 2960</div><div class="line">    frame #28: 0x0000000189af7da0 UIKit`-[UIApplication sendEvent:] + 340</div><div class="line">    frame #29: 0x000000018a2e175c UIKit`__dispatchPreprocessedEventFromEventQueue + 2736</div><div class="line">    frame #30: 0x000000018a2db130 UIKit`__handleEventQueue + 784</div><div class="line">    frame #31: 0x0000000183bf6b5c CoreFoundation`__CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE0_PERFORM_FUNCTION__ + 24</div><div class="line">    frame #32: 0x0000000183bf64a4 CoreFoundation`__CFRunLoopDoSources0 + 524</div><div class="line">    frame #33: 0x0000000183bf40a4 CoreFoundation`__CFRunLoopRun + 804</div><div class="line">    frame #34: 0x0000000183b222b8 CoreFoundation`CFRunLoopRunSpecific + 444</div><div class="line">    frame #35: 0x00000001855d6198 GraphicsServices`GSEventRunModal + 180</div><div class="line">    frame #36: 0x0000000189b627fc UIKit`-[UIApplication _run] + 684</div><div class="line">    frame #37: 0x0000000189b5d534 UIKit`UIApplicationMain + 208</div><div class="line">    frame #38: 0x00000001000da9a4 DuoYiIMOrig`main(argc=&lt;unavailable&gt;, argv=&lt;unavailable&gt;) at main.m:15 [opt]</div><div class="line">    frame #39: 0x0000000182b055b8 libdyld.dylib`start + 4</div></pre></td></tr></table></figure>
<h2 id="æ¢å¤-OC-ç¬¦å·"><a href="#æ¢å¤-OC-ç¬¦å·" class="headerlink" title="æ¢å¤ OC ç¬¦å·"></a>æ¢å¤ OC ç¬¦å·</h2><p>ç¬¬ä¸‰æ–¹ app å¾€å¾€éƒ½å»é™¤äº†ç¬¦å·ï¼Œå»ºè®®è¿›è¡Œä¸€ä¸‹æ¢å¤ç¬¦å·è¡¨çš„æ“ä½œã€‚æ¢å¤ç¬¦å·è¡¨åï¼Œåœ¨è°ƒè¯•æ—¶å°±èƒ½ç›´æ¥åœ¨å †æ ˆä¸­çœ‹åˆ°æ–¹æ³•åï¼Œå…å»äº†è®¡ç®—åç§»é‡ç„¶ååœ¨ hopper é‡ŒæŸ¥æ‰¾çš„éº»çƒ¦ã€‚å‚è€ƒï¼š<a href="http://blog.imjun.net/posts/restore-symbol-of-iOS-app/" target="_blank" rel="external">iOSç¬¦å·è¡¨æ¢å¤&amp;é€†å‘æ”¯ä»˜å®</a>, <a href="https://github.com/tobefuturer/restore-symbol" target="_blank" rel="external">restore-symbol</a>ã€‚</p>
<h2 id="ç”¨-Xcode-ç›´æ¥è°ƒè¯•"><a href="#ç”¨-Xcode-ç›´æ¥è°ƒè¯•" class="headerlink" title="ç”¨ Xcode ç›´æ¥è°ƒè¯•"></a>ç”¨ Xcode ç›´æ¥è°ƒè¯•</h2><p>é™¤äº†ç”¨å‘½ä»¤è¡Œï¼Œä¹Ÿå¯ä»¥ç›´æ¥ç”¨ Xcode è¿›è¡Œ lldb è°ƒè¯•ï¼Œæœ‰äº†å›¾å½¢ç•Œé¢ï¼Œä¹Ÿèƒ½ä½¿ç”¨<code>Debug UI Hierarchy</code>å’Œ<code>Debug Memory Graph</code>å·¥å…·ã€‚å‚è€ƒ<a href="https://zuikyo.github.io/2017/05/04/iOSé€†å‘ï¼šç”¨Xcodeç›´æ¥è°ƒè¯•ç¬¬ä¸‰æ–¹app/">iOSé€†å‘ï¼šç”¨Xcodeç›´æ¥è°ƒè¯•ç¬¬ä¸‰æ–¹app</a>ã€‚</p>
<p>å¦‚æœæ˜¯ iOS 11 ä¹‹å‰çš„è¶Šç‹±è®¾å¤‡ï¼Œéœ€è¦é‡ç­¾ååæ‰èƒ½ç”¨ Xcode è°ƒè¯•ã€‚iOS 11 ä¹‹åæ²¡æœ‰é™åˆ¶ï¼Œå¯ä»¥ç›´æ¥ç”¨ Xcode è°ƒè¯• App Store ä¸Šä¸‹è½½çš„ appã€‚</p>
<h2 id="lldbå¸¸ç”¨å‘½ä»¤"><a href="#lldbå¸¸ç”¨å‘½ä»¤" class="headerlink" title="lldbå¸¸ç”¨å‘½ä»¤"></a>lldbå¸¸ç”¨å‘½ä»¤</h2><p>è¦æƒ³å……åˆ†å‘æŒ¥ lldb çš„åŠ¨æ€è°ƒè¯•åŠŸèƒ½ï¼Œå¿…é¡»è¦å­¦ä¼šä½¿ç”¨ lldb å‘½ä»¤ã€‚</p>
<p>lldbå‘½ä»¤å¯ä»¥åœ¨å®˜ç½‘æŸ¥çœ‹ï¼š<a href="http://lldb.llvm.org/lldb-gdb.html" target="_blank" rel="external">GDB to LLDB Command Map</a>ã€‚ä¹Ÿå¯ä»¥å‚è€ƒï¼š<a href="https://objccn.io/issue-19-2/" target="_blank" rel="external">ä¸è°ƒè¯•å™¨å…±èˆ - LLDB çš„åå°”å…¹</a>ã€‚</p>
<p>å¸¸ç”¨å‘½ä»¤å¦‚ä¸‹ï¼š</p>
<h3 id="æ±‚å€¼ã€æ‰“å°"><a href="#æ±‚å€¼ã€æ‰“å°" class="headerlink" title="æ±‚å€¼ã€æ‰“å°"></a>æ±‚å€¼ã€æ‰“å°</h3><ul>
<li><code>expression</code>, <code>expr</code>, <code>e</code>ï¼šåé¢å¯ä»¥æ‰§è¡Œä¸€æ®µä»£ç </li>
<li><code>print</code>, <code>prin</code>, <code>pri</code>, <code>p</code>ã€‚æ˜¯<code>expression --</code>çš„ç¼©å†™ã€‚å¯ä»¥ç”¨<code>p/x</code>, <code>p/t</code>, <code>p/c</code>, <code>p/s</code>åˆ†ææ‰“å°16è¿›åˆ¶ã€äºŒè¿›åˆ¶ã€å­—ç¬¦ã€å­—ç¬¦ä¸²æ ¼å¼</li>
<li><code>po</code>æ˜¯<code>e -o --</code>çš„ç¼©å†™ã€‚è¡¨ç¤ºä»¥ å¯¹è±¡ (Object) çš„æ ¼å¼æ¥æ‰“å°ç»“æœ</li>
<li>æ±‚å€¼ä¹‹åä¼šä¿å­˜ä¸ºä¸´æ—¶å˜é‡ï¼Œä½¿ç”¨å˜é‡æ—¶ä»¥<code>$</code>å¼€å¤´ï¼š<code>e int $a = 2</code> <code>p $a * 19</code></li>
</ul>
<h3 id="æµç¨‹æ§åˆ¶"><a href="#æµç¨‹æ§åˆ¶" class="headerlink" title="æµç¨‹æ§åˆ¶"></a>æµç¨‹æ§åˆ¶</h3><ul>
<li><code>process continue</code>, <code>continue</code>, <code>c</code></li>
<li><code>thread step-over</code>, <code>next</code>, <code>n</code></li>
<li><code>thread step in</code>, <code>step</code>, <code>s</code></li>
<li><code>thread step-out</code>, <code>finish</code></li>
<li><code>thread return &lt;RETURN EXPRESSION&gt;</code>ï¼šè¿”å›æŒ‡å®šå€¼</li>
</ul>
<h3 id="æ–­ç‚¹-1"><a href="#æ–­ç‚¹-1" class="headerlink" title="æ–­ç‚¹"></a>æ–­ç‚¹</h3><ul>
<li><code>breakpoint list</code>, <code>br li</code>ï¼šåˆ—å‡ºæ‰€æœ‰æ–­ç‚¹</li>
<li><code>breakpoint enable</code>, <code>breakpoint disable</code>, <code>br dis</code>, <code>br del</code>ï¼šåé¢è·Ÿæ–­ç‚¹çš„åºå·ï¼Œæ‰“å¼€ã€å…³é—­æŸä¸ªæ–­ç‚¹</li>
<li><code>breakpoint set -f main.m -l 16</code>ï¼šåœ¨æºç æ–‡ä»¶çš„æŸä¸€è¡Œæ–­ç‚¹</li>
<li><code>b main.m:17</code>ã€‚<code>b</code>æ˜¯<code>_regexp-break</code>çš„ç¼©å†™</li>
<li>ç¬¦å·æ–­ç‚¹ï¼š<code>b isEven</code>, <code>br s -F isEven</code></li>
<li>ç”¨æ­£åˆ™è¡¨è¾¾å¼è¿›è¡Œç¬¦å·æ–­ç‚¹ï¼š<code>br set -r &#39;æ­£åˆ™&#39;</code></li>
<li>æ–­ç‚¹æ¡ä»¶ï¼š<code>breakpoint modify -c &#39;i == 99&#39; 1</code></li>
<li>æ–­ç‚¹æ—¶é™„åŠ è‡ªå®šä¹‰æ“ä½œï¼š<code>breakpoint command add 1</code></li>
</ul>
<h3 id="ç›‘æ§åœ°å€"><a href="#ç›‘æ§åœ°å€" class="headerlink" title="ç›‘æ§åœ°å€"></a>ç›‘æ§åœ°å€</h3><ul>
<li>å†…å­˜ç›‘æ§ï¼š</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">// è·å–éœ€è¦ç›‘æ§çš„å†…å­˜åœ°å€</div><div class="line">p (ptrdiff_t)ivar_getOffset((struct Ivar *)class_getInstanceVariable([MyView class], &quot;_layer&quot;))</div><div class="line"></div><div class="line">(ptrdiff_t) $0 = 8</div></pre></td></tr></table></figure>
<p><code>watchpoint set expression -- (int *)$myView + 8</code>ï¼šç›‘æ§<code>_layer</code>çš„åœ°å€</p>
<ul>
<li>å˜é‡ç›‘æ§ï¼š<code>watchpoint set variable -w read_write</code></li>
<li>æ¡ä»¶ç›‘æ§ï¼š<code>watchpoint modify -c &#39;(global==5)&#39;</code></li>
</ul>
<h3 id="å†…å­˜ï¼Œæ ˆä¿¡æ¯"><a href="#å†…å­˜ï¼Œæ ˆä¿¡æ¯" class="headerlink" title="å†…å­˜ï¼Œæ ˆä¿¡æ¯"></a>å†…å­˜ï¼Œæ ˆä¿¡æ¯</h3><ul>
<li>æ‰“å°å‚æ•°ï¼š<code>frame variable</code>, <code>fr v</code></li>
<li>æ‰“å°æ–¹æ³•åå’Œè¡Œæ•°ï¼š<code>frame info</code></li>
<li>æ‰“å°å¯„å­˜å™¨çš„å€¼ï¼š<code>register read</code></li>
<li>ä¿®æ”¹å¯„å­˜å™¨çš„å€¼ï¼š<code>register write rax 123</code></li>
<li>æ‰“å°æ ˆå›æº¯ï¼š<code>thread backtrace</code>, <code>bt</code>, <code>bt all</code></li>
<li>æ‰“å°çº¿ç¨‹åµŒå¥—çš„æ ˆå›æº¯ï¼š<code>thread backtrace -e true</code></li>
<li>è¯»å–å†…å­˜ï¼š<code>memory read --size 4 --format x --count 4 0xbffff3c0</code>, <code>me r -s4 -fx -c4 0xbffff3c0</code></li>
<li>è·å–å†…å­˜åˆ›å»ºæ ˆï¼š<code>script import lldb.macosx.heap</code> <code>malloc_info --stack-history 0x10010d680</code>ã€‚å¯ä»¥å¿«é€Ÿè¿½æº¯å¯¹è±¡çš„åˆ›å»ºæ¥æºï¼Œå‚è€ƒ<a href="https://zuikyo.github.io/2017/05/04/iOSé€†å‘ï¼šåœ¨ä»»æ„appä¸Šå¼€å¯malloc%20stackè¿½è¸ªå†…å­˜æ¥æº/">iOSé€†å‘ï¼šåœ¨ä»»æ„appä¸Šå¼€å¯malloc stackè¿½è¸ªå†…å­˜æ¥æº</a></li>
</ul>
<h3 id="åæ±‡ç¼–"><a href="#åæ±‡ç¼–" class="headerlink" title="åæ±‡ç¼–"></a>åæ±‡ç¼–</h3><ul>
<li><code>disassemble --start-address 0x1eb8 --end-address 0x1ec3</code></li>
<li><code>disassemble --start-address 0x1eb8 --count 20</code></li>
<li><code>disassemble --frame --mixed</code>, <code>di -f -m</code></li>
<li><code>image list</code></li>
<li><code>image lookup --address 0x1ec4</code></li>
</ul>
<h2 id="lldb-å‘½ä»¤æ‰©å±•"><a href="#lldb-å‘½ä»¤æ‰©å±•" class="headerlink" title="lldb å‘½ä»¤æ‰©å±•"></a>lldb å‘½ä»¤æ‰©å±•</h2><p>lldb å¯ä»¥ä½¿ç”¨ python è„šæœ¬ç¼–å†™è‡ªå®šä¹‰åŠŸèƒ½ã€‚å¯ä»¥å®‰è£… facebook çš„å¼€æºåº“<a href="https://github.com/facebook/chisel" target="_blank" rel="external">chisel</a>ï¼Œæä¾›äº†å¾ˆå¤šéå¸¸æœ‰ç”¨çš„å‘½ä»¤ã€‚</p>
<p>å®‰è£…æ­¥éª¤å¦‚ä¸‹ã€‚</p>
<p>Mac ä¸­ç”¨<code>brew install chisel</code>ä¸‹è½½ chiselï¼Œé»˜è®¤å®‰è£…åˆ°<code>/usr/local/opt/chisel</code>ã€‚</p>
<p>ä¹Ÿå¯ä»¥æ‰‹åŠ¨ä» github ä¸Šä¸‹è½½ã€‚</p>
<p>ä¸‹è½½åæ‰“å¼€ Mac ä¸Šçš„<code>~/.lldbinit</code>ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™æ‰‹åŠ¨åˆ›å»ºä¸€ä¸ªã€‚åœ¨é‡Œé¢æ·»åŠ <code>chisel</code>ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"># ~/.lldbinit</div><div class="line"></div><div class="line"># å¦‚æœæ˜¯é€šè¿‡ brew install chisel å®‰è£…</div><div class="line">command script import /usr/local/opt/chisel/libexec/fblldb.py</div><div class="line"></div><div class="line"># å¦‚æœæ˜¯æ‰‹åŠ¨ä¸‹è½½ï¼Œåˆ™å¡«å†™ chisel é‡Œçš„ fblldb.py è·¯å¾„</div><div class="line">command script import /path/to/fblldb.py</div></pre></td></tr></table></figure>
<p>ä¹‹åé‡å¯ Xcodeï¼Œå°±èƒ½ä½¿ç”¨ä¸‹é¢è¿™äº›éå¸¸æœ‰ç”¨çš„å‘½ä»¤äº†ã€‚</p>
<table>
<thead>
<tr>
<th>å‘½ä»¤</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>ç›®å½•</strong></td>
<td></td>
</tr>
<tr>
<td>pdocspath</td>
<td>æ‰“å° app çš„æ²™ç›’ Documents ç›®å½•</td>
</tr>
<tr>
<td>pbundlepath</td>
<td>æ‰“å° app çš„ bundle ç›®å½•</td>
</tr>
<tr>
<td><strong>å¯¹è±¡æŸ¥æ‰¾</strong></td>
<td></td>
</tr>
<tr>
<td>fv</td>
<td>ç”¨æ­£åˆ™æŸ¥æ‰¾æ‰€æœ‰ç±»çš„ view å®ä¾‹</td>
</tr>
<tr>
<td>fvc</td>
<td>ç”¨æ­£åˆ™æŸ¥æ‰¾æ‰€æœ‰ç±»çš„ view controller å®ä¾‹</td>
</tr>
<tr>
<td>findinstances</td>
<td>åœ¨å†…å­˜ä¸­æŸ¥æ‰¾æŸä¸ªç±»çš„æ‰€æœ‰å®ä¾‹</td>
</tr>
<tr>
<td>flicker</td>
<td>é—ªçƒæŸä¸ª viewï¼Œç”¨äºå¿«é€Ÿå®šä½</td>
</tr>
<tr>
<td><strong>å¯¹è±¡åˆ†æ</strong></td>
<td></td>
</tr>
<tr>
<td>pinternals</td>
<td>æ‰“å°å¯¹è±¡å†…éƒ¨çš„æ‰€æœ‰å®ä¾‹å˜é‡</td>
</tr>
<tr>
<td>pkp</td>
<td>ç”¨ <code>-valueForKeyPath:</code>è·å–å¯¹è±¡çš„æ•°æ®</td>
</tr>
<tr>
<td>pmethods</td>
<td>æ‰“å°ç±»çš„æ‰€æœ‰æ–¹æ³•</td>
</tr>
<tr>
<td>poobjc</td>
<td>ç”¨ ObjC++ è¯­è¨€æ‰§è¡Œå’Œè·å–è¡¨è¾¾å¼çš„ç»“æœï¼Œ<code>expression -O -l ObjC++ â€”</code>çš„ç¼©å†™</td>
</tr>
<tr>
<td>pproperties</td>
<td>æ‰“å°å¯¹è±¡æˆ–è€…ç±»çš„å±æ€§</td>
</tr>
<tr>
<td>pivar</td>
<td>æ‰“å°å¯¹è±¡çš„æŸä¸ª ivar</td>
</tr>
<tr>
<td>wivar</td>
<td>ç»™å¯¹è±¡çš„æŸä¸ªå®ä¾‹å˜é‡åœ°å€è®¾ç½® watchpointï¼Œç›‘æ§å˜åŒ–</td>
</tr>
<tr>
<td>pclass</td>
<td>æ‰“å°æŸä¸ªå¯¹è±¡çš„ç±»ç»§æ‰¿é“¾</td>
</tr>
<tr>
<td>pbcopy</td>
<td>æ‰“å°å¯¹è±¡å¹¶ä¸”æŠŠç»“æœå¤åˆ¶åˆ°ç²˜è´´æ¿</td>
</tr>
<tr>
<td>pblock</td>
<td>æ‰“å° block çš„å®ç°å‡½æ•°åœ°å€å’Œç­¾å</td>
</tr>
<tr>
<td>pactions</td>
<td>æ‰“å° UIControl çš„ target  å’Œ action</td>
</tr>
<tr>
<td><strong>æ–­ç‚¹</strong></td>
<td></td>
</tr>
<tr>
<td>bdisable</td>
<td>ç”¨æ­£åˆ™æŸ¥æ‰¾å¹¶å…³é—­ä¸€ç»„æ–­ç‚¹ </td>
</tr>
<tr>
<td>benable</td>
<td>ç”¨æ­£åˆ™æŸ¥æ‰¾å¹¶å¼€å¯ä¸€ç»„æ–­ç‚¹</td>
</tr>
<tr>
<td>binside</td>
<td>ç”¨ç›¸å¯¹åœ°å€è®¾ç½®æ–­ç‚¹ï¼Œè‡ªåŠ¨åŠ ä¸Š ALSR åç§»</td>
</tr>
<tr>
<td>bmessage</td>
<td>ç»™æŸä¸ªç±»çš„ method è®¾ç½®æ–­ç‚¹ï¼ŒåŒæ—¶ä¼šåœ¨å…¶çˆ¶ç±»ä¸ŠæŸ¥æ‰¾ method</td>
</tr>
<tr>
<td>pinvocation</td>
<td>æ‰“å°æ–¹æ³•è°ƒç”¨å †æ ˆï¼Œä»…æ”¯æŒx86</td>
</tr>
<tr>
<td><strong>è§†å›¾æŸ¥æ‰¾</strong></td>
<td></td>
</tr>
<tr>
<td>visualize</td>
<td>æ˜¾ç¤º UIImage, CGImageRef, UIView æˆ– CALayer çš„å›¾ç‰‡å†…å®¹ï¼Œç”¨ Mac çš„é¢„è§ˆæ‰“å¼€ï¼Œåœ¨è°ƒè¯•ç»˜å›¾æ—¶éå¸¸æœ‰ç”¨</td>
</tr>
<tr>
<td>taplog</td>
<td>æ‰“å°è§¦æ‘¸åˆ°çš„ viewï¼Œç”¨äºå¿«é€Ÿå®šä½</td>
</tr>
<tr>
<td>border</td>
<td>ç»™ view åŠ ä¸Šè¾¹æ¡†ï¼Œç”¨äºå®šä½æŸä¸ª view å¯¹è±¡</td>
</tr>
<tr>
<td>unborder</td>
<td>ç§»é™¤ view æˆ– layer çš„è¾¹æ¡†</td>
</tr>
<tr>
<td>caflush</td>
<td>ä¿®æ”¹ UI ååˆ·æ–° Core Animation ç•Œé¢</td>
</tr>
<tr>
<td>hide</td>
<td>éšè— view æˆ– layer</td>
</tr>
<tr>
<td>show</td>
<td>æ˜¾ç¤ºä¸€ä¸ª view æˆ–è€… layerï¼Œç›¸å½“äºæ‰§è¡Œ<code>view.hidden = NO</code></td>
</tr>
<tr>
<td>mask</td>
<td>ç»™ view æ·»åŠ åŠé€æ˜çš„ maskï¼Œå¯ä»¥ç”¨æ¥æŸ¥æ‰¾è¢«éšè—çš„ view</td>
</tr>
<tr>
<td>unmask</td>
<td>ç§»é™¤ view layer çš„ mask</td>
</tr>
<tr>
<td>setinput</td>
<td>ç»™ä½œä¸º first responder çš„  text field æˆ– text view è¾“å…¥æ–‡æœ¬</td>
</tr>
<tr>
<td>slowanim</td>
<td>å‡æ…¢åŠ¨ç”»é€Ÿåº¦</td>
</tr>
<tr>
<td>unslowanim</td>
<td>åŠ¨ç”»é€Ÿåº¦å›å¤æ­£å¸¸</td>
</tr>
<tr>
<td>present</td>
<td>Present ä¸€ä¸ª view controller</td>
</tr>
<tr>
<td>dismiss</td>
<td>æ¶ˆé™¤ present å‡ºæ¥çš„ view controller</td>
</tr>
<tr>
<td><strong>è§†å›¾å±‚çº§</strong></td>
<td></td>
</tr>
<tr>
<td>pvc</td>
<td>å¾ªç¯æ‰“å° view controller çš„å±‚çº§</td>
</tr>
<tr>
<td>pviews</td>
<td>å¾ªç¯æ‰“å° view çš„å±‚çº§</td>
</tr>
<tr>
<td>pca</td>
<td>æ‰“å° layer æ ‘</td>
</tr>
<tr>
<td>vs</td>
<td>åœ¨ view å±‚çº§ä¸­æœç´¢ view</td>
</tr>
<tr>
<td>ptv</td>
<td>æ‰“å°æœ€é¡¶å±‚çš„ table view</td>
</tr>
<tr>
<td>pcells</td>
<td>æ‰“å°æœ€é¡¶å±‚ table view çš„æ‰€æœ‰å¯è§çš„ cell</td>
</tr>
<tr>
<td>presponder</td>
<td>æ‰“å° UIResponder å“åº”è€…é“¾</td>
</tr>
<tr>
<td><strong>å…¶ä»–å·¥å…·</strong></td>
<td></td>
</tr>
<tr>
<td>sequence</td>
<td>æ‰§è¡Œå¤šæ¡å‘½ä»¤ï¼Œç”¨<code>;</code>åˆ†éš”</td>
</tr>
<tr>
<td>pjson</td>
<td>æ‰“å° NSDictionary æˆ– NSArray çš„ JSON æ ¼å¼</td>
</tr>
<tr>
<td>pcurl</td>
<td>ç”¨ curl çš„æ ¼å¼æ˜¾ç¤º NSURLRequest (HTTP)</td>
</tr>
<tr>
<td>pdata</td>
<td>ç”¨å­—ç¬¦ä¸²çš„å½¢å¼æ˜¾ç¤º NSData</td>
</tr>
<tr>
<td>mwarning</td>
<td>æ¨¡æ‹Ÿå†…å­˜è­¦å‘Š</td>
</tr>
<tr>
<td><strong>è§†å›¾è°ƒè¯•</strong></td>
<td></td>
</tr>
<tr>
<td>alamborder</td>
<td>ç»™æœ‰çº¦æŸé”™è¯¯çš„ view åŠ ä¸Šè¾¹æ¡†</td>
</tr>
<tr>
<td>alamunborder</td>
<td>æœ‰çº¦æŸé”™è¯¯çš„ view åŠ ä¸Šè¾¹æ¡†</td>
</tr>
<tr>
<td>paltrace</td>
<td>æ‰“å° view çš„çº¦æŸä¿¡æ¯ï¼Œç›¸å½“äºè°ƒç”¨<code>_autolayoutTrace</code></td>
</tr>
<tr>
<td>panim</td>
<td>æ˜¯å¦æ­£åœ¨æ‰§è¡ŒåŠ¨ç”»ï¼Œç›¸å½“äºè°ƒç”¨<code>[UIView _isInAnimationBlock]</code></td>
</tr>
</tbody>
</table>
<h2 id="å‡ ä¸ªæœ‰ç”¨çš„ç§æœ‰æ–¹æ³•"><a href="#å‡ ä¸ªæœ‰ç”¨çš„ç§æœ‰æ–¹æ³•" class="headerlink" title="å‡ ä¸ªæœ‰ç”¨çš„ç§æœ‰æ–¹æ³•"></a>å‡ ä¸ªæœ‰ç”¨çš„ç§æœ‰æ–¹æ³•</h2><p><code>NSObject</code>æœ‰ä¸€äº›å¾ˆæœ‰ç”¨çš„ç§æœ‰æ–¹æ³•ï¼Œå¯ä»¥æ–¹ä¾¿æŸ¥çœ‹å¯¹è±¡çš„å†…å®¹ï¼š</p>
<ul>
<li><p><code>_methodDescription</code>ï¼šæ‰“å°å¯¹è±¡æˆ–è€…ç±»çš„æ•´ä¸ªç»§æ‰¿é“¾ä¸Šçš„æ–¹æ³•åˆ—è¡¨ï¼ŒåŒæ—¶æ˜¾ç¤ºæ–¹æ³•çš„åœ°å€ï¼Œå¯ä»¥ç›´æ¥ç”¨äºæ–­ç‚¹</p>
</li>
<li><p><code>_shortMethodDescription</code> ï¼šæ‰“å°å¯¹è±¡æˆ–è€…ç±»çš„æ–¹æ³•åˆ—è¡¨ï¼Œä¸æ˜¾ç¤ºçˆ¶ç±»</p>
</li>
<li><p><code>_ivarDescription</code>ï¼šæ‰“å°å¯¹è±¡æˆ–è€…ç±»çš„æ‰€æœ‰å®ä¾‹å˜é‡å’Œå€¼</p>
</li>
</ul>
<h2 id="è‡ªå®šä¹‰-lldb-è„šæœ¬"><a href="#è‡ªå®šä¹‰-lldb-è„šæœ¬" class="headerlink" title="è‡ªå®šä¹‰ lldb è„šæœ¬"></a>è‡ªå®šä¹‰ lldb è„šæœ¬</h2><p>ä½ å¯ä»¥ ç”¨ Python è„šæœ¬ç¼–å†™è‡ªå·±çš„ lldb å‘½ä»¤ï¼Œå¯ä»¥è¿›ä¸€æ­¥æå‡åŠ¨æ€è°ƒè¯•çš„æ•ˆç‡ã€‚</p>
<h3 id="å‘½ä»¤åˆ«å"><a href="#å‘½ä»¤åˆ«å" class="headerlink" title="å‘½ä»¤åˆ«å"></a>å‘½ä»¤åˆ«å</h3><p>å¯ä»¥åœ¨<code>~/.lldbinit</code>ä¸­æ·»åŠ  lldb çš„åˆå§‹åŒ–å‘½ä»¤ï¼Œå¦‚æœæ²¡æœ‰è¿™ä¸ªæ–‡ä»¶å°±åˆ›å»ºä¸€ä¸ªã€‚</p>
<p>ç”¨<code>command alias</code>æ·»åŠ å¿«æ·å‘½ä»¤ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># reloadscript å‘½ä»¤ï¼šä¿®æ”¹è„šæœ¬æ–‡ä»¶åï¼Œé‡æ–°åŠ è½½</div><div class="line">command alias reloadscript command source ~/.lldbinit</div></pre></td></tr></table></figure>
<p>ä¹‹åè¾“å…¥<code>reloadscript</code>å°±ç›¸å½“äºè¾“å…¥<code>command source ~/.lldbinit</code>ã€‚</p>
<h3 id="ç¼–å†™è‡ªå®šä¹‰è„šæœ¬"><a href="#ç¼–å†™è‡ªå®šä¹‰è„šæœ¬" class="headerlink" title="ç¼–å†™è‡ªå®šä¹‰è„šæœ¬"></a>ç¼–å†™è‡ªå®šä¹‰è„šæœ¬</h3><p>ç¼–å†™ Python è„šæœ¬ï¼Œæ ¼å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># some_script.py</span></div><div class="line"><span class="keyword">import</span> lldb</div><div class="line"></div><div class="line"><span class="comment"># æ‰§è¡Œå‘½ä»¤</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(debugger, command, result, internal_dict)</span>:</span></div><div class="line">    <span class="string">"""</span></div><div class="line">    Print root view controller of key window</div><div class="line">    """</div><div class="line">    print(<span class="string">"hello world!"</span>)</div><div class="line">    debugger.HandleCommand(<span class="string">'po (id)[(id)[(id)[UIApplication sharedApplication] keyWindow] rootViewController]'</span>)</div><div class="line">    </div><div class="line"></div><div class="line"><span class="comment"># lldb å¯åŠ¨å…¥å£</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">__lldb_init_module</span><span class="params">(debugger, internal_dict)</span>:</span></div><div class="line">    <span class="comment"># æ·»åŠ  ptopvc å‘½ä»¤</span></div><div class="line">    debugger.HandleCommand(<span class="string">'command script add -f some_script.run ptopvc'</span>)</div></pre></td></tr></table></figure>
<p>å¦‚æœæœ‰<code>chisel</code>ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨<code>chisel</code>é‡Œå°è£…å¥½çš„æ¨¡å—å’Œå„ç§å‡½æ•°ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># some_script.py</span></div><div class="line"><span class="keyword">import</span> lldb</div><div class="line"><span class="keyword">import</span> fblldbbase <span class="keyword">as</span> fb</div><div class="line">    </div><div class="line"><span class="comment"># å¯ä»¥åŒæ—¶å£°æ˜å¤šä¸ªå‘½ä»¤</span></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">lldbcommands</span><span class="params">()</span>:</span></div><div class="line">  <span class="keyword">return</span> [ SomeCommand() ]</div><div class="line"></div><div class="line"><span class="comment"># å®šä¹‰å‘½ä»¤</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">SomeCommand</span><span class="params">(fb.FBCommand)</span>:</span></div><div class="line">  </div><div class="line">  <span class="comment"># å‘½ä»¤å</span></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">name</span><span class="params">(self)</span>:</span></div><div class="line">    <span class="keyword">return</span> <span class="string">'ptopvc'</span></div><div class="line"></div><div class="line">  <span class="comment"># æè¿°</span></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">description</span><span class="params">(self)</span>:</span></div><div class="line">    <span class="keyword">return</span> <span class="string">'Print root view controller of key window'</span></div><div class="line"></div><div class="line">  <span class="comment"># é€‰é¡¹</span></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">options</span><span class="params">(self)</span>:</span></div><div class="line">    <span class="keyword">return</span> [</div><div class="line">      fb.FBCommandArgument(short=<span class="string">'-v'</span>, long=<span class="string">'--verbose'</span>, help=<span class="string">'Show ivar of the result object'</span>, default=<span class="keyword">False</span>, boolean=<span class="keyword">True</span>)</div><div class="line">    ]</div><div class="line"></div><div class="line">  <span class="comment"># å‚æ•°</span></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">args</span><span class="params">(self)</span>:</span></div><div class="line">    <span class="keyword">return</span> [ fb.FBCommandArgument(arg=<span class="string">'instance or class'</span>, type=<span class="string">'instance or Class'</span>, help=<span class="string">'an Objective-C Class.'</span>) ]</div><div class="line"></div><div class="line">  <span class="comment"># æ‰§è¡Œå‘½ä»¤</span></div><div class="line">  <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self, arguments, options)</span>:</span></div><div class="line">    print(<span class="string">"hello world!"</span>)</div><div class="line">    fb.evaluateExpression(<span class="string">'(id)[(id)[(id)[UIApplication sharedApplication] keyWindow] rootViewController]'</span>)</div></pre></td></tr></table></figure>
<p>è¯¦æƒ…è¯·è§<code>chisel</code>ä»£ç ã€‚</p>
<p>å†™è„šæœ¬æ—¶å¯ä»¥éšæ—¶åœ¨ lldb é‡Œè°ƒç”¨<code>reloadscript</code>å‘½ä»¤é‡æ–°åŠ è½½ï¼Œè¿›è¡Œæµ‹è¯•ã€‚</p>
<p>è„šæœ¬æä¾›äº†æ“ä½œ lldb çš„æ¥å£ï¼Œä¾‹å¦‚è®¾ç½®æ–­ç‚¹ã€æ‰§è¡Œå‘½ä»¤ã€‚ä¸è¿‡ç¼–å†™å‘½ä»¤æœ‰äº›å‘ï¼š</p>
<ul>
<li>å¤§éƒ¨åˆ† OC æ–¹æ³•å’Œå‡½æ•°éƒ½éœ€è¦æ˜ç¡®å£°æ˜è¿”å›å€¼ç±»å‹</li>
<li>æŒ‡é’ˆå£°æ˜æ—¶éœ€è¦åˆå§‹åŒ–ï¼Œä¸ä¼šé»˜è®¤è®¾ä¸º nilï¼Œå¦åˆ™åœ¨ä½¿ç”¨æ—¶ä¼šå‡ºç°é‡æŒ‡é’ˆ</li>
</ul>
<h3 id="å¯¼å…¥è‡ªå®šä¹‰è„šæœ¬"><a href="#å¯¼å…¥è‡ªå®šä¹‰è„šæœ¬" class="headerlink" title="å¯¼å…¥è‡ªå®šä¹‰è„šæœ¬"></a>å¯¼å…¥è‡ªå®šä¹‰è„šæœ¬</h3><p>æ‰“å¼€<code>~/.lldbinit</code>æ·»åŠ ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"># å¯¼å…¥è‡ªå®šä¹‰è„šæœ¬çš„è·¯å¾„</div><div class="line">command script import /path/to/some_script.py</div><div class="line"></div><div class="line"># å¯ä»¥é€šè¿‡ chisel æä¾›çš„å‡½æ•°å¯¼å…¥ç›®å½•ä¸‹çš„æ‰€æœ‰è„šæœ¬</div><div class="line">script fblldb.loadCommandsInDirectory(&apos;/Users/xxx/Documents/code/lldbScript/&apos;)</div></pre></td></tr></table></figure>
<h2 id="å®æˆ˜æ¼”ç»ƒï¼šè¿½è¸ªblockå›è°ƒ"><a href="#å®æˆ˜æ¼”ç»ƒï¼šè¿½è¸ªblockå›è°ƒ" class="headerlink" title="å®æˆ˜æ¼”ç»ƒï¼šè¿½è¸ªblockå›è°ƒ"></a>å®æˆ˜æ¼”ç»ƒï¼šè¿½è¸ªblockå›è°ƒ</h2><p>ä¸‹é¢æ¼”ç»ƒä¸€ä¸‹ lldb è°ƒè¯•çš„è¿‡ç¨‹ã€‚</p>
<p>æœ‰æ—¶å€™é€»è¾‘æ˜¯é€šè¿‡blockå›è°ƒæ¥æ‰§è¡Œçš„ï¼Œè¿½è¸ªè°ƒç”¨è·¯å¾„æ—¶ï¼Œéœ€è¦æ‰¾å‡ºblockçš„æ‰§è¡Œåœ°å€ã€‚ç›´æ¥æ‰“å°blockå¯¹è±¡å¹¶ä¸ä¼šæ˜¾ç¤ºæ‰§è¡Œåœ°å€ï¼Œéœ€è¦åˆ†æå†…å­˜æ‰èƒ½æ‰¾å‡ºã€‚ä¸‹é¢çš„åˆ†ææµç¨‹å’Œ lldb å‘½ä»¤<code>pblock</code>æ˜¯ä¸€æ ·çš„ã€‚</p>
<h3 id="blockçš„ç»“æ„"><a href="#blockçš„ç»“æ„" class="headerlink" title="blockçš„ç»“æ„"></a>blockçš„ç»“æ„</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">struct Block_literal_1 &#123;</div><div class="line">    void *isa; // initialized to &amp;_NSConcreteStackBlock or &amp;_NSConcreteGlobalBlock</div><div class="line">    int flags;</div><div class="line">    int reserved;</div><div class="line">    void (*invoke)(void *, ...);</div><div class="line">    struct Block_descriptor_1 &#123;</div><div class="line">        unsigned long int reserved;     // NULL</div><div class="line">        unsigned long int size;         // sizeof(struct Block_literal_1)</div><div class="line">        // optional helper functions</div><div class="line">        // void (*copy_helper)(void *dst, void *src);     // IFF (1&lt;&lt;25)</div><div class="line">        // void (*dispose_helper)(void *src);             // IFF (1&lt;&lt;25)</div><div class="line">        // required ABI.2010.3.16</div><div class="line">        // const char *signature;                         // IFF (1&lt;&lt;30)</div><div class="line">        void* rest[1];</div><div class="line">    &#125; *descriptor;</div><div class="line">    // imported variables</div><div class="line">&#125;;</div><div class="line"></div><div class="line">enum &#123;</div><div class="line">    BLOCK_HAS_COPY_DISPOSE =  (1 &lt;&lt; 25),</div><div class="line">    BLOCK_HAS_CTOR =          (1 &lt;&lt; 26), // helpers have C++ code</div><div class="line">    BLOCK_IS_GLOBAL =         (1 &lt;&lt; 28),</div><div class="line">    BLOCK_HAS_STRET =         (1 &lt;&lt; 29), // IFF BLOCK_HAS_SIGNATURE</div><div class="line">    BLOCK_HAS_SIGNATURE =     (1 &lt;&lt; 30),</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h3 id="æŸ¥çœ‹invokeæŒ‡é’ˆçš„åœ°å€"><a href="#æŸ¥çœ‹invokeæŒ‡é’ˆçš„åœ°å€" class="headerlink" title="æŸ¥çœ‹invokeæŒ‡é’ˆçš„åœ°å€"></a>æŸ¥çœ‹invokeæŒ‡é’ˆçš„åœ°å€</h3><p>æ¼”ç¤ºä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">- (void)modifyUIAtBackbround &#123;</div><div class="line">    void(^crash)() = ^ &#123;</div><div class="line">       dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^&#123;</div><div class="line">            [self.view addSubview:[[UIView alloc] init]];</div><div class="line">        &#125;);</div><div class="line">    &#125;;</div><div class="line">    </div><div class="line">    crash();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å½“è·å–åˆ°ä¸€ä¸ªblockå˜é‡æ—¶ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Printing description of $x1:</div><div class="line">&lt;__NSStackBlock__: 0x16fd465b8&gt;</div></pre></td></tr></table></figure>
<p>æŸ¥çœ‹<code>0x16fd465b8</code>çš„å†…å­˜ï¼Œç”±äºå­—èŠ‚å¯¹é½çš„åŸå› ï¼Œç»“æ„ä½“å†…çš„æ•°æ®æ˜¯æŒ‰ç…§æœ€å¤§çš„8å­—èŠ‚å¯¹é½çš„ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">(lldb) memory read --size 8 --format x 0x16fd465b8</div><div class="line">0x16fd465b8: 0x00000001a94520d8 0x00000000c2000000</div><div class="line">0x16fd465c8: 0x00000001000bf77c 0x000000010012c9f0</div><div class="line">0x16fd465d8: 0x0000000131e0a610 0x00000001700517f0</div><div class="line">0x16fd465e8: 0x00000001700517f0 0x000000016fd46650</div></pre></td></tr></table></figure>
<p>void *isa å ç”¨8å­—èŠ‚ï¼Œintå ç”¨4å­—èŠ‚ï¼Œæ‰€ä»¥invokeæŒ‡é’ˆçš„å€¼æ˜¯<code>0x00000001000bf77c</code>ï¼Œ<code>descriptor</code>çš„åœ°å€æ˜¯<code>0x000000010012c9f0</code>ã€‚</p>
<p>å¯¹åœ°å€åæ±‡ç¼–ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line">disassemble -a 0x00000001000bf77c</div><div class="line">MyApp`__38-[ViewController modifyUIAtBackbround]_block_invoke_2:</div><div class="line">    0x1000bf77c &lt;+0&gt;:   sub    sp, sp, #0x30             ; =0x30 </div><div class="line">    0x1000bf780 &lt;+4&gt;:   stp    x29, x30, [sp, #0x20]</div><div class="line">    0x1000bf784 &lt;+8&gt;:   add    x29, sp, #0x20            ; =0x20 </div><div class="line">    0x1000bf788 &lt;+12&gt;:  adrp   x8, 125</div><div class="line">    0x1000bf78c &lt;+16&gt;:  add    x8, x8, #0xe0             ; =0xe0 </div><div class="line">    0x1000bf790 &lt;+20&gt;:  stur   x0, [x29, #-0x8]</div><div class="line">    0x1000bf794 &lt;+24&gt;:  mov    x9, x0</div><div class="line">    0x1000bf798 &lt;+28&gt;:  str    x9, [sp, #0x10]</div><div class="line">    0x1000bf79c &lt;+32&gt;:  ldr    x9, [x0, #0x20]</div><div class="line">    0x1000bf7a0 &lt;+36&gt;:  ldr    x1, [x8]</div><div class="line">    0x1000bf7a4 &lt;+40&gt;:  mov    x0, x9</div><div class="line">    0x1000bf7a8 &lt;+44&gt;:  bl     0x100113e98               ; symbol stub for: objc_msgSend</div><div class="line">    0x1000bf7ac &lt;+48&gt;:  mov    x29, x29</div><div class="line">    0x1000bf7b0 &lt;+52&gt;:  bl     0x100113eec               ; symbol stub for: objc_retainAutoreleasedReturnValue</div><div class="line">    0x1000bf7b4 &lt;+56&gt;:  adrp   x8, 124</div><div class="line">    0x1000bf7b8 &lt;+60&gt;:  add    x8, x8, #0xed0            ; =0xed0 </div><div class="line">    0x1000bf7bc &lt;+64&gt;:  adrp   x9, 126</div><div class="line">    0x1000bf7c0 &lt;+68&gt;:  add    x9, x9, #0x308            ; =0x308 </div><div class="line">    0x1000bf7c4 &lt;+72&gt;:  ldr    x9, [x9]</div><div class="line">    0x1000bf7c8 &lt;+76&gt;:  ldr    x1, [x8]</div><div class="line">    0x1000bf7cc &lt;+80&gt;:  str    x0, [sp, #0x8]</div><div class="line">    0x1000bf7d0 &lt;+84&gt;:  mov    x0, x9</div><div class="line">    0x1000bf7d4 &lt;+88&gt;:  bl     0x100113e98               ; symbol stub for: objc_msgSend</div><div class="line">    0x1000bf7d8 &lt;+92&gt;:  adrp   x8, 124</div><div class="line">    0x1000bf7dc &lt;+96&gt;:  add    x8, x8, #0xed8            ; =0xed8 </div><div class="line">    0x1000bf7e0 &lt;+100&gt;: ldr    x1, [x8]</div><div class="line">    0x1000bf7e4 &lt;+104&gt;: bl     0x100113e98               ; symbol stub for: objc_msgSend</div><div class="line">    0x1000bf7e8 &lt;+108&gt;: adrp   x8, 125</div><div class="line">    0x1000bf7ec &lt;+112&gt;: add    x8, x8, #0xe8             ; =0xe8 </div><div class="line">    0x1000bf7f0 &lt;+116&gt;: ldr    x1, [x8]</div><div class="line">    0x1000bf7f4 &lt;+120&gt;: ldr    x8, [sp, #0x8]</div><div class="line">    0x1000bf7f8 &lt;+124&gt;: str    x0, [sp]</div><div class="line">    0x1000bf7fc &lt;+128&gt;: mov    x0, x8</div><div class="line">    0x1000bf800 &lt;+132&gt;: ldr    x2, [sp]</div><div class="line">    0x1000bf804 &lt;+136&gt;: bl     0x100113e98               ; symbol stub for: objc_msgSend</div><div class="line">    0x1000bf808 &lt;+140&gt;: ldr    x0, [sp]</div><div class="line">    0x1000bf80c &lt;+144&gt;: bl     0x100113ebc               ; symbol stub for: objc_release</div><div class="line">    0x1000bf810 &lt;+148&gt;: ldr    x0, [sp, #0x8]</div><div class="line">    0x1000bf814 &lt;+152&gt;: bl     0x100113ebc               ; symbol stub for: objc_release</div><div class="line">    0x1000bf818 &lt;+156&gt;: ldp    x29, x30, [sp, #0x20]</div><div class="line">    0x1000bf81c &lt;+160&gt;: add    sp, sp, #0x30             ; =0x30 </div><div class="line">    0x1000bf820 &lt;+164&gt;: ret</div></pre></td></tr></table></figure>
<h3 id="æŸ¥çœ‹blockçš„ç­¾å"><a href="#æŸ¥çœ‹blockçš„ç­¾å" class="headerlink" title="æŸ¥çœ‹blockçš„ç­¾å"></a>æŸ¥çœ‹blockçš„ç­¾å</h3><p>å¦‚æœè¦è¿›ä¸€æ­¥æŸ¥çœ‹blockçš„ç­¾åï¼Œé¦–å…ˆæ£€æŸ¥blockçš„flagsï¼Œç¡®å®šå†…å­˜å¸ƒå±€ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">(lldb) p (BOOL)(0x00000000c2000000 &amp; (1&lt;&lt;30))</div><div class="line">(BOOL) $37 = YES</div><div class="line">(lldb) p (BOOL)(0x00000000c2000000 &amp; (1&lt;&lt;25))</div><div class="line">(BOOL) $38 = YES</div></pre></td></tr></table></figure>
<p>flags <code>BLOCK_HAS_COPY_DISPOSE</code>ä¸ºYESï¼Œè¯´æ˜<code>descriptor</code>é‡Œæœ‰<code>dispose_helper</code>å’Œ<code>dispose_helper</code>ï¼Œ<code>signature</code>åœ¨ç¬¬8 + 8 + 8 + 8 = 32ä¸ªå­—èŠ‚ã€‚</p>
<p>æŸ¥çœ‹<code>descriptor</code>çš„å†…å­˜ï¼Œç¬¬32ä¸ªå­—èŠ‚çš„å†…å®¹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">(lldb) memory read --size 8 --format x 0x000000010012c9f0</div><div class="line">0x10012c9f0: 0x0000000000000000 0x0000000000000028</div><div class="line">0x10012ca00: 0x00000001000bf824 0x00000001000bf870</div><div class="line">0x10012ca10: 0x0000000100115c77 0x0000000000000100</div><div class="line">0x10012ca20: 0x0000000000000000 0x0000000000000028</div><div class="line">(lldb) po (const char *)0x0000000100115c77</div><div class="line">&quot;v8@?0&quot;</div></pre></td></tr></table></figure>
<p>æŸ¥çœ‹ç­¾åï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">(lldb) po [NSMethodSignature signatureWithObjCTypes:&quot;v8@?0&quot;]</div><div class="line">&lt;NSMethodSignature: 0x17027bd80&gt;</div><div class="line">    number of arguments = 1</div><div class="line">    frame size = 224</div><div class="line">    is special struct return? NO</div><div class="line">    return value: -------- -------- -------- --------</div><div class="line">        type encoding (v) &apos;v&apos;</div><div class="line">        flags &#123;&#125;</div><div class="line">        modifiers &#123;&#125;</div><div class="line">        frame &#123;offset = 0, offset adjust = 0, size = 0, size adjust = 0&#125;</div><div class="line">        memory &#123;offset = 0, size = 0&#125;</div><div class="line">    argument 0: -------- -------- -------- --------</div><div class="line">        type encoding (@) &apos;@?&apos;</div><div class="line">        flags &#123;isObject, isBlock&#125;</div><div class="line">        modifiers &#123;&#125;</div><div class="line">        frame &#123;offset = 0, offset adjust = 0, size = 8, size adjust = 0&#125;</div><div class="line">        memory &#123;offset = 0, size = 8&#125;</div></pre></td></tr></table></figure>
<h2 id="Cycript"><a href="#Cycript" class="headerlink" title="Cycript"></a>Cycript</h2><p>Cycript æ˜¯ Saruik å¤§ä½¬å¼€å‘çš„åŠ¨æ€è°ƒè¯•å·¥å…·ï¼Œå†…ç½®äº†ä¸€å¥— JavaScript è§£é‡Šå™¨ï¼Œå¯ä»¥ç”¨ js è„šæœ¬å’Œ OC äº¤äº’ï¼Œç”¨ js æ‰§è¡Œ OC ä»£ç ï¼Œå†…ç½®äº†ä¸€äº›å¾ˆæœ‰ç”¨çš„åŠŸèƒ½ã€‚å®˜ç½‘ï¼š<a href="http://www.cycript.org" target="_blank" rel="external">http://www.cycript.org</a>ï¼Œæºç åœ°å€ï¼š<a href="https://git.saurik.com/cycript.git" target="_blank" rel="external">https://git.saurik.com/cycript.git</a>ã€‚</p>
<p>å…¶å® cycript çš„å¤§éƒ¨åˆ†åŠŸèƒ½é€šè¿‡ lldb éƒ½èƒ½å®ç°ã€‚å®ƒçš„ä¼˜åŠ¿æ˜¯é›†æˆäº†è¶Šç‹±ç³»ç»Ÿä¸­çš„ substrate åº“ï¼Œå¯ä»¥å¿«é€Ÿåœ°è¿›è¡Œ hookï¼Œå¹¶ä¸” js è¯­æ³•å†™èµ·æ¥æ¯”è¾ƒç®€å•ã€‚</p>
<h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><p>è¶Šç‹±æœºå» Cydia ä¸­å¯ä»¥ç›´æ¥æœç´¢ä¸‹è½½ cycriptã€‚ç°åœ¨ cycript çš„å…¼å®¹æ€§æœ‰ç‚¹é—®é¢˜ï¼Œæ²¡æœ‰é€‚é… iOS 11 è¶Šç‹±ï¼Œå› æ­¤ iOS 11 åœ¨ Cydia é‡Œæ‰¾ä¸åˆ° cycriptã€‚éœ€è¦è‡ªå·±å»ä½¿ç”¨è¿™ä¸ª<a href="https://github.com/BishopFox/bfinject" target="_blank" rel="external">bfinject</a>ï¼Œå¦‚æœå®‰è£…å¤±è´¥ï¼Œåˆ™å°è¯•è¿™ä¸ªåˆ†æ”¯ï¼š<a href="https://github.com/klmitchell2/bfinject" target="_blank" rel="external">klmitchell2/bfinject</a>ã€‚</p>
<p>é™¤äº†ä»ç¬¬ä¸‰æ–¹å®‰è£…ï¼Œä½ ä¹Ÿå¯ä»¥å»å®˜ç½‘ä¸‹è½½ cycript çš„ SDK é›†æˆåˆ° app ä¸­ä½¿ç”¨ã€‚</p>
<h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><p>å®‰è£…åï¼Œssh è¿æ¥åˆ° iOS è®¾å¤‡ï¼Œä½¿ç”¨<code>ps -e</code>æ‰¾åˆ°æƒ³è¦è°ƒè¯•çš„è¿›ç¨‹ï¼Œä½¿ç”¨<code>cycript -p &lt;pid&gt;</code>è¿æ¥æŒ‡å®šçš„è¿›ç¨‹å·åï¼Œå°±è¿›å…¥äº†<code>cycript</code>çš„è°ƒè¯•æ§åˆ¶å°ã€‚</p>
<p>åœ¨æ§åˆ¶å°é‡Œï¼Œå¯ä»¥æŠŠ js å’Œ OC è¯­æ³•æ··ç”¨ã€‚</p>
<h4 id="æ–¹æ³•è°ƒç”¨å’Œæ±‚å€¼"><a href="#æ–¹æ³•è°ƒç”¨å’Œæ±‚å€¼" class="headerlink" title="æ–¹æ³•è°ƒç”¨å’Œæ±‚å€¼"></a>æ–¹æ³•è°ƒç”¨å’Œæ±‚å€¼</h4><p>è°ƒç”¨ OC æ–¹æ³•ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cy# UIApplication.sharedApplication().windows[0].contentView().subviews()[0]</div><div class="line">#&quot;&lt;SBFStaticWallpaperView: 0x1590ca730; frame = (0 0; 375 667); autoresize = W+H; layer = &lt;CALayer: 0x1590cabd0&gt;&gt;&quot;</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cy# var c = [[UIApp windows][0] contentView]</div><div class="line">#&quot;&lt;UIView: 0x10e883d40; frame = (0 0; 320 568); layer = &lt;CALayer: 0x10e883e00&gt;&gt;&quot;</div></pre></td></tr></table></figure>
<p>é€šè¿‡åœ°å€è·å–å¯¹è±¡ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cy# c = #0x10e883d40</div><div class="line">#&quot;&lt;UIView: 0x10e883d40; frame = (0 0; 320 568); layer = &lt;CALayer: 0x10e883e00&gt;&gt;&quot;</div></pre></td></tr></table></figure>
<p>è·å–å®ä¾‹å˜é‡çš„å€¼ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cy# c-&gt;_subviewCache</div><div class="line">@[#&quot;&lt;SBFStaticWallpaperView: 0x11459fc40; frame = (0 0; 320 568); autoresize = W+H; layer = &lt;CALayer: 0x11459ee70&gt;&gt;&quot;]</div></pre></td></tr></table></figure>
<p>æ‰“å°å¯¹è±¡çš„å®ä¾‹å˜é‡ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cy# *c</div><div class="line">&#123;isa:&quot;UIView&quot;,_layer:#&quot;&lt;CALayer: 0x10e883e00&gt;&quot;,_gestureInfo:null,_gestureRecognizers:null,_subviewCache:@[#&quot;&lt;SBFStaticWallpaperView: 0x11459fc40; frame = (0 0; 320 568); autoresize = W+H; layer = &lt;CALayer: 0x11459ee70&gt;&gt;&quot;],_charge:0,_tag:0,_viewDelegate:null,_backgroundColorSystemColorName:null,_countOfMotionEffectsInSubtree:1,_viewFlags:@error,_retainCount:8,_tintAdjustmentDimmingCount:0,_shouldArchiveUIAppearanceTags:false,_interactionTintColor:null,_layoutEngine:null,_boundsWidthVariable:null,_boundsHeightVariable:null,_minXVariable:null,_minYVariable:null,_internalConstraints:null,_constraintsExceptingSubviewAutoresizingConstraints:null&#125;</div></pre></td></tr></table></figure>
<h4 id="è°ƒç”¨-C-å‡½æ•°"><a href="#è°ƒç”¨-C-å‡½æ•°" class="headerlink" title="è°ƒç”¨ C å‡½æ•°"></a>è°ƒç”¨ C å‡½æ•°</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">cy# extern &quot;C&quot; int getuid();</div><div class="line">(extern &quot;C&quot; int getuid())</div><div class="line">cy# getuid()</div><div class="line">501</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">cy# getuid = dlsym(RTLD_DEFAULT, &quot;getuid&quot;)</div><div class="line">(typedef void*)(0x7fff885f95b0)</div><div class="line">cy# getuid()</div><div class="line">throw new Error(&quot;cannot call a pointer to non-function&quot;)</div><div class="line">cy# getuid = (typedef int())(getuid)</div><div class="line">(extern &quot;C&quot; int getuid())</div><div class="line">cy# getuid()</div><div class="line">501</div></pre></td></tr></table></figure>
<h4 id="æ·»åŠ -category"><a href="#æ·»åŠ -category" class="headerlink" title="æ·»åŠ  category"></a>æ·»åŠ  category</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">cy# @implementation NSObject (MyCategory)</div><div class="line">    - description &#123; return &quot;hello&quot;; &#125;</div><div class="line">    - (double) f:(int)v  &#123; return v * 0.5; &#125;</div><div class="line">    @end</div><div class="line">cy# o = [new NSObject init]</div><div class="line">#&quot;hello&quot;</div><div class="line">cy# [o f:3]</div><div class="line">1.5</div></pre></td></tr></table></figure>
<h4 id="æŸ¥æ‰¾æŒ‡å®šç±»çš„å¯¹è±¡"><a href="#æŸ¥æ‰¾æŒ‡å®šç±»çš„å¯¹è±¡" class="headerlink" title="æŸ¥æ‰¾æŒ‡å®šç±»çš„å¯¹è±¡"></a>æŸ¥æ‰¾æŒ‡å®šç±»çš„å¯¹è±¡</h4><p>Cycript çš„<code>choose</code>å‘½ä»¤å¯ä»¥åˆ—å‡ºæŒ‡å®šç±»çš„æ‰€æœ‰å®ä¾‹å¯¹è±¡ï¼Œå’Œ lldb å‘½ä»¤<code>findinstances</code>ç±»ä¼¼ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cy# choose(SBIconModel)</div><div class="line">[#&quot;&lt;SBIconModel: 0x1590c8430&gt;&quot;]</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cy# var views = choose(SBIconView)</div><div class="line">[#&quot;&lt;SBIconView: 0x159460fa0; frame = (27 92; 60 74); opaque = NO; gestureRecognizers = &lt;NSArray: 0x159518ae0&gt;; layer = &lt;CALayer: 0x159461220&gt;&gt;&quot;,#&quot;&lt;SBIconView: 0x159468e50; frame = (114 356; 60 74); opaque = NO; gestureRecognizers = &lt;NSArray: 0x15946d2f0&gt;; layer = &lt;CALayer: 0x1592c9a70&gt;&gt;&quot;,...</div></pre></td></tr></table></figure>
<h4 id="hook"><a href="#hook" class="headerlink" title="hook"></a>hook</h4><p>é€šè¿‡ js åŸå‹æ“ä½œå¯¹è±¡ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cy# var oldm = NSObject.prototype.description</div><div class="line">(extern &quot;C&quot; id &quot;:description&quot;(id, SEL))</div></pre></td></tr></table></figure>
<p>ä¿®æ”¹ prototype è¿›è¡Œ hookï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">cy# NSObject.prototype.description = function() &#123; return oldm.call(this) + &apos; (of doom)&apos;; &#125;</div><div class="line">cy# [new NSObject init]</div><div class="line">#&quot;&lt;NSObject: 0x100d11520&gt; (of doom)&quot;</div></pre></td></tr></table></figure>
<p>Cycript ä¸­ä¹Ÿå¯ä»¥ä½¿ç”¨è¶Šç‹±æœºä¸Šçš„ hook æ¡†æ¶<code>Cydia Substrate</code>ã€‚ä½¿ç”¨<code>MS.hookMessage</code>hook OC æ–¹æ³•ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">cy# @import com.saurik.substrate.MS</div><div class="line">cy# var oldm = &#123;&#125;;</div><div class="line">cy# MS.hookMessage(NSObject, @selector(description), function() &#123;</div><div class="line">        return oldm-&gt;call(this) + &quot; (of doom)&quot;;</div><div class="line">    &#125;, oldm)</div><div class="line">cy# [new NSObject init]</div><div class="line">#&quot;&lt;NSObject: 0x100203d10&gt; (of doom)&quot;</div></pre></td></tr></table></figure>
<p>ä½¿ç”¨<code>MS.hookFunction</code>hook C å‡½æ•°ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">cy# @import com.saurik.substrate.MS</div><div class="line">cy# extern &quot;C&quot; void *fopen(char *, char *);</div><div class="line">cy# var oldf = &#123;&#125;</div><div class="line">cy# var log = []</div><div class="line">cy# MS.hookFunction(fopen, function(path, mode) &#123;</div><div class="line">        var file = (*oldf)(path, mode);</div><div class="line">        log.push([path.toString(), mode.toString(), file]);</div><div class="line">        return file;</div><div class="line">    &#125;, oldf)</div><div class="line">cy# fopen(&quot;/etc/passwd&quot;, &quot;r&quot;);</div><div class="line">(typedef void*)(0x7fff774ff2a0)</div><div class="line">cy# log</div><div class="line">[[&quot;/etc/passwd&quot;,&quot;r&quot;,(typedef void*)(0x7fff774ff2a0)]]</div></pre></td></tr></table></figure>
<h2 id="Frida"><a href="#Frida" class="headerlink" title="Frida"></a>Frida</h2><p>Frida æ˜¯ä¸€ä¸ªè·¨å¹³å°çš„åŠ¨æ€è°ƒè¯•å·¥å…·ï¼Œå¯ä»¥ç”¨ js è„šæœ¬å’Œ OC è¿›è¡Œäº¤äº’ï¼Œä»è€Œæ‰§è¡Œä»£ç ã€æ‰“logã€hook å‡½æ•°ã€‚å’Œ cycript ç±»ä¼¼ï¼Œä¸è¿‡å…¼å®¹æ€§æ¯” cycript è¦å¥½ã€‚åŒæ ·çš„ï¼Œfrida èƒ½åšçš„ï¼Œç”¨ lldb åŸºæœ¬ä¸Šä¹Ÿèƒ½åšåˆ°ã€‚Frida çš„ä¼˜åŠ¿æ˜¯è·¨å¹³å°ï¼Œä»¥åŠæä¾›çš„ js åº“ã€å‘½ä»¤è¡Œï¼Œèƒ½å¤Ÿå®ç°è„šæœ¬åŒ–ã€‚<a href="https://www.frida.re/docs" target="_blank" rel="external">Frida å®˜ç½‘</a>ã€‚</p>
<h3 id="å®‰è£…-1"><a href="#å®‰è£…-1" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><p>Mac ç«¯å®‰è£… fridaï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">pip install --user frida-tools</div></pre></td></tr></table></figure>
<p>iOS è®¾å¤‡åœ¨ Cydia ä¸­æ·»åŠ æºï¼š <a href="https://build.frida.re/" target="_blank" rel="external">https://build.frida.re</a>ï¼Œä¹‹ååœ¨ Cydia ä¸­æœç´¢ frida å®‰è£…ã€‚</p>
<h3 id="ä½¿ç”¨-1"><a href="#ä½¿ç”¨-1" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><h4 id="åˆ—å‡ºè¿›ç¨‹"><a href="#åˆ—å‡ºè¿›ç¨‹" class="headerlink" title="åˆ—å‡ºè¿›ç¨‹"></a>åˆ—å‡ºè¿›ç¨‹</h4><p>åœ¨ mac ä¸Šæ‰§è¡Œ<code>frida-ps -U</code>ç­‰å¾… iOS è®¾å¤‡è¿æ¥åˆ° USBï¼Œè¿æ¥åˆ°åå°±ä¼šåˆ—å‡º iOS è®¾å¤‡ä¸Šæ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ã€‚</p>
<p>ä¹Ÿå¯ä»¥ç”¨<code>frida-ps -Uai</code>åˆ—å‡ºæ­£åœ¨è¿è¡Œçš„ appã€‚</p>
<h4 id="è°ƒç”¨è¿½è¸ª"><a href="#è°ƒç”¨è¿½è¸ª" class="headerlink" title="è°ƒç”¨è¿½è¸ª"></a>è°ƒç”¨è¿½è¸ª</h4><p>å¯ä»¥ä½¿ç”¨<code>frida-trace</code>è¿½è¸ª app çš„è°ƒç”¨ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"># Trace recv* and send* APIs in Safari</div><div class="line">$ frida-trace -i &quot;recv*&quot; -i &quot;send*&quot; Safari</div><div class="line"></div><div class="line"># Trace ObjC method calls in Safari</div><div class="line">$ frida-trace -m &quot;-[NSView drawRect:]&quot; Safari</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">~ $ frida-trace -i &quot;recv*&quot; -i &quot;read*&quot; *twitter*</div><div class="line">recv: Auto-generated handler: â€¦/recv.js</div><div class="line"># (snip)</div><div class="line">recvfrom: Auto-generated handler: â€¦/recvfrom.js</div><div class="line">Started tracing 21 functions. Press Ctrl+C to stop.</div><div class="line">    39 ms	recv()</div><div class="line">   112 ms	recvfrom()</div><div class="line">   128 ms	recvfrom()</div><div class="line">   129 ms	recvfrom()</div></pre></td></tr></table></figure>
<h3 id="è¿æ¥æŒ‡å®šè¿›ç¨‹"><a href="#è¿æ¥æŒ‡å®šè¿›ç¨‹" class="headerlink" title="è¿æ¥æŒ‡å®šè¿›ç¨‹"></a>è¿æ¥æŒ‡å®šè¿›ç¨‹</h3><p>ä½¿ç”¨<code>frida -U &lt;appå&gt;</code>è¿æ¥åˆ°æŒ‡å®šè¿›ç¨‹ï¼Œä¹Ÿå¯ä»¥åŒæ—¶æ³¨å…¥ js è„šæœ¬ï¼š<code>frida -n Twitter -l demo1.js</code>ã€‚</p>
<p>è¿æ¥ä¸Šåï¼Œå°±å¯ä»¥æ‰§è¡Œ frida çš„ js å‘½ä»¤ï¼Œä»¥åŠè¿è¡Œæ³¨å…¥çš„ js è„šæœ¬ã€‚</p>
<p>Frida æä¾›äº†å¼ºå¤§çš„ js åº“ï¼Œå¯ä»¥å»å®˜ç½‘æŸ¥çœ‹å®Œæ•´çš„ API æ–‡æ¡£ï¼š<a href="https://www.frida.re/docs/javascript-api/" target="_blank" rel="external">JavaScript API</a>ã€‚è¿™é‡Œåªåˆ—å‡ºä¸€äº›æœ‰ç”¨çš„æ¥å£ã€‚</p>
<h3 id="æ‰§è¡Œè„šæœ¬"><a href="#æ‰§è¡Œè„šæœ¬" class="headerlink" title="æ‰§è¡Œè„šæœ¬"></a>æ‰§è¡Œè„šæœ¬</h3><h4 id="ä¸-OC-äº¤äº’"><a href="#ä¸-OC-äº¤äº’" class="headerlink" title="ä¸ OC äº¤äº’"></a>ä¸ OC äº¤äº’</h4><p>å‚è€ƒ<a href="https://www.frida.re/docs/javascript-api/#objc" target="_blank" rel="external">JavaScript API: ObjC</a>ã€‚</p>
<p>è·å– OC ç±»åˆ—è¡¨ï¼š<code>ObjC.classes</code></p>
<p>è·å–æŒ‡å®šç±»ï¼š<code>var NSString = ObjC.classes.NSString;</code>ï¼Œå¹¶è°ƒç”¨ç±»æ–¹æ³•ï¼š<code>NSString.stringWithString_(&quot;Hello World&quot;);</code></p>
<p>è°ƒç”¨å®ä¾‹æ–¹æ³•ï¼š<code>NSString.alloc().initWithString_(&quot;Hello World&quot;);</code></p>
<p>GCD çº¿ç¨‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">ObjC.schedule(ObjC.mainQueue, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    NSString.stringWithString_(<span class="string">"Hello World"</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>è·å–å†…å­˜ä¸­æŒ‡å®šç±»çš„æ‰€æœ‰å®ä¾‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">ObjC.choose(ObjC.classes.UIViewController, &#123;</div><div class="line">            onMatch: function (instance) &#123;</div><div class="line">                console.log(&quot;Found instance: &quot; + instance);</div><div class="line">            &#125;,</div><div class="line">            onComplete: function () &#123; &#125;</div><div class="line">truetruetruetruetruetruetrue// æœç´¢å®Œæ¯•</div><div class="line">        &#125;);</div></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">var viewControllers = ObjC.chooseSync(ObjC.classes.UIViewController)</div></pre></td></tr></table></figure>
<p>è·å– OC å¯¹è±¡ï¼š<code>new ObjC.Object(ptr(&quot;0x1234&quot;))</code></p>
<p>å¯ä»¥é€šè¿‡ js å¯¹è±¡çš„å±æ€§è·å– OC å¯¹è±¡çš„å†…å®¹ï¼š</p>
<ul>
<li><code>$kind</code>: string specifying either <code>instance</code>, <code>class</code> or <code>meta-class</code></li>
<li><code>$super</code>: an <em>ObjC.Object</em> instance used for chaining up to super-class method implementations</li>
<li><code>$superClass</code>: super-class as an <em>ObjC.Object</em> instance</li>
<li><code>$class</code>: class of this object as an <em>ObjC.Object</em> instance</li>
<li><code>$className</code>: string containing the class name of this object</li>
<li><code>$protocols</code>: object mapping protocol name to <code>ObjC.Protocol</code> instance for each of the protocols that this object conforms to</li>
<li><code>$methods</code>: array containing native method names exposed by this objectâ€™s class and parent classes</li>
<li><code>$ownMethods</code>: array containing native method names exposed by this objectâ€™s class, not including parent classes</li>
<li><code>$ivars</code>: object mapping each instance variable name to its current value, allowing you to read and write each through access and assignment</li>
</ul>
<h4 id="è°ƒç”¨-C-å‡½æ•°-1"><a href="#è°ƒç”¨-C-å‡½æ•°-1" class="headerlink" title="è°ƒç”¨ C å‡½æ•°"></a>è°ƒç”¨ C å‡½æ•°</h4><p>è·å– C å‡½æ•°æŒ‡é’ˆï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> sqlite3_sql = Module.getExportByName(<span class="string">'libsqlite3.dylib'</span>, <span class="string">'sqlite3_sql'</span>);</div><div class="line"></div><div class="line"><span class="keyword">var</span> openPtr = Module.findExportByName(<span class="literal">null</span>,<span class="string">"open"</span>);</div></pre></td></tr></table></figure>
<p>è°ƒç”¨ C å‡½æ•°ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> sqlite3_sql = <span class="keyword">new</span> NativeFunction(sqlite3_sqlPtr, <span class="string">'char'</span>, [<span class="string">'pointer'</span>]);</div><div class="line">sqlite3_sql(statement);</div><div class="line"></div><div class="line"><span class="keyword">var</span> open = <span class="keyword">new</span> NativeFunction(openPtr, <span class="string">'int'</span>, [<span class="string">'pointer'</span>, <span class="string">'int'</span>]);</div><div class="line"><span class="keyword">var</span> fd = open(Memory.allocUtf8String(<span class="string">'/tmp/test.txt'</span>), <span class="number">0</span>);</div></pre></td></tr></table></figure>
<h4 id="hook-1"><a href="#hook-1" class="headerlink" title="hook"></a>hook</h4><p>Hook OC æ–¹æ³•ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Get a reference to the openURL selector</span></div><div class="line"><span class="keyword">var</span> openURL = ObjC.classes.UIApplication[<span class="string">"- openURL:"</span>];</div><div class="line"></div><div class="line"><span class="comment">// Intercept the method</span></div><div class="line">Interceptor.attach(openURL.implementation, &#123;</div><div class="line">  onEnter: <span class="function"><span class="keyword">function</span>(<span class="params">args</span>) </span>&#123;</div><div class="line">    <span class="comment">// æ–¹æ³•æ‰§è¡Œå‰è°ƒç”¨</span></div><div class="line">    <span class="comment">// As this is an ObjectiveC method, the arguments are as follows:</span></div><div class="line">    <span class="comment">// 0. 'self'</span></div><div class="line">    <span class="comment">// 1. The selector (openURL:)</span></div><div class="line">    <span class="comment">// 2. The first argument to the openURL selector</span></div><div class="line">    <span class="keyword">var</span> myNSURL = <span class="keyword">new</span> ObjC.Object(args[<span class="number">2</span>]);</div><div class="line">    <span class="comment">// Convert it to a JS string</span></div><div class="line">    <span class="keyword">var</span> myJSURL = myNSURL.absoluteString().toString();</div><div class="line">    <span class="comment">// Log it</span></div><div class="line">    <span class="built_in">console</span>.log(<span class="string">"Launching URL: "</span> + myJSURL);</div><div class="line">  &#125;,</div><div class="line">  onLeave: <span class="function"><span class="keyword">function</span> (<span class="params">retval</span>) </span>&#123;</div><div class="line">    <span class="comment">// æ‰§è¡Œåè°ƒç”¨</span></div><div class="line">    <span class="comment">// ä¿®æ”¹è¿”å›å€¼</span></div><div class="line">    retval.replace(<span class="number">1</span>)</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>æ›¿æ¢ C å‡½æ•°ï¼ˆOC æ–¹æ³•åŒç†ï¼‰ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> openPtr = Module.getExportByName(<span class="literal">null</span>, <span class="string">'open'</span>);</div><div class="line"><span class="keyword">var</span> open = <span class="keyword">new</span> NativeFunction(openPtr, <span class="string">'int'</span>, [<span class="string">'pointer'</span>, <span class="string">'int'</span>]);</div><div class="line">Interceptor.replace(openPtr, <span class="keyword">new</span> NativeCallback(<span class="function"><span class="keyword">function</span> (<span class="params">pathPtr, flags</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> path = pathPtr.readUtf8String();</div><div class="line">  log(<span class="string">'Opening "'</span> + path + <span class="string">'"'</span>);</div><div class="line">  <span class="keyword">var</span> fd = open(pathPtr, flags);</div><div class="line">  <span class="built_in">console</span>.log(<span class="string">'Got fd: '</span> + fd);</div><div class="line">  <span class="keyword">return</span> fd;</div><div class="line">&#125;, <span class="string">'int'</span>, [<span class="string">'pointer'</span>, <span class="string">'int'</span>]));</div></pre></td></tr></table></figure>
<p>Hook C å‡½æ•°ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">Interceptor.attach(Module.getExportByName(<span class="literal">null</span>, <span class="string">'open'</span>), &#123;</div><div class="line">  onEnter: <span class="function"><span class="keyword">function</span> (<span class="params">args</span>) </span>&#123;</div><div class="line">    <span class="comment">// æ‰§è¡Œå‰è°ƒç”¨</span></div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'Context information:'</span>);</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'Context  : '</span> + <span class="built_in">JSON</span>.stringify(<span class="keyword">this</span>.context));</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'Return   : '</span> + <span class="keyword">this</span>.returnAddress);</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'ThreadId : '</span> + <span class="keyword">this</span>.threadId);</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'Depth    : '</span> + <span class="keyword">this</span>.depth);</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'Errornr  : '</span> + <span class="keyword">this</span>.err);</div><div class="line"></div><div class="line">    <span class="comment">// Save arguments for processing in onLeave.</span></div><div class="line">    <span class="keyword">this</span>.fd = args[<span class="number">0</span>].toInt32();</div><div class="line">    <span class="keyword">this</span>.buf = args[<span class="number">1</span>];</div><div class="line">    <span class="keyword">this</span>.count = args[<span class="number">2</span>].toInt32();</div><div class="line">  &#125;,</div><div class="line">  onLeave: <span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span>&#123;</div><div class="line">    <span class="comment">// æ‰§è¡Œåè°ƒç”¨</span></div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'----------'</span>)</div><div class="line">    <span class="comment">// Show argument 1 (buf), saved during onEnter.</span></div><div class="line">    <span class="keyword">var</span> numBytes = result.toInt32();</div><div class="line">    <span class="keyword">if</span> (numBytes &gt; <span class="number">0</span>) &#123;</div><div class="line">      <span class="built_in">console</span>.log(hexdump(<span class="keyword">this</span>.buf, &#123; length: numBytes, ansi: <span class="literal">true</span> &#125;));</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'Result   : '</span> + numBytes);</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h2 id="IDA-åŠ¨æ€è°ƒè¯•"><a href="#IDA-åŠ¨æ€è°ƒè¯•" class="headerlink" title="IDA åŠ¨æ€è°ƒè¯•"></a>IDA åŠ¨æ€è°ƒè¯•</h2><p>IDA ä¹Ÿæœ‰ä¸€ä¸ªåŠ¨æ€è°ƒè¯•å·¥å…·ï¼Œä¸è¿‡æ²¡æœ‰ lldb è¿™ä¹ˆå¤šé’ˆå¯¹ iOS å¹³å°çš„å‘½ä»¤ï¼Œåªè¦æ˜¯ç”¨æ¥è¾…åŠ©é€†å‘åˆ†æï¼ŒæŸ¥çœ‹æ§åˆ¶æµï¼Œæ‰“logã€‚IDA çš„ trace åŠŸèƒ½å¯ä»¥ä»æŒ‡ä»¤çº§åˆ«ä¸Šè®°å½•è¿è¡Œæ—¶ç¨‹åºçš„æµç¨‹ï¼ŒæŸ¥çœ‹å¯„å­˜å™¨å’Œå†…å­˜çš„å€¼ï¼Œä¸è¿‡ IDA è°ƒè¯•çš„åŒæ—¶ä¸èƒ½ä½¿ç”¨ lldbï¼Œå¦‚æœæƒ³è¦æŸ¥çœ‹å…¶ä»–è¯¦ç»†ä¿¡æ¯ï¼Œå¯ä»¥é…åˆ cycript æˆ– fridaã€‚</p>
<p>å¦‚æœä½ æƒ³åˆ†æä»£ç çš„æ§åˆ¶æµï¼Œå¯ä»¥ä½¿ç”¨ IDA çš„åŠ¨æ€è°ƒè¯•ã€‚IDA ä¹Ÿæœ‰ä¸€äº›ç¬¬ä¸‰æ–¹æ’ä»¶ç”¨äºè¾…åŠ©è°ƒè¯•ã€‚</p>
<h3 id="é…ç½®-debugger"><a href="#é…ç½®-debugger" class="headerlink" title="é…ç½® debugger"></a>é…ç½® debugger</h3><p>IDA æä¾›äº† iOS çš„ debuggerã€‚é¦–å…ˆå°†ç ¸å£³åçš„ app ç”¨ IDA åˆ†æå®Œæ¯•ï¼Œå†é‡ç­¾ååå®‰è£…åˆ° iOS è®¾å¤‡ä¸Šï¼Œç›®çš„æ˜¯è®© IDA åˆ†æçš„äºŒè¿›åˆ¶æ–‡ä»¶å’Œè®¾å¤‡ä¸Šçš„ä¿æŒä¸€è‡´ã€‚</p>
<p>ä¹‹åè®¾ç½® IDA çš„ debugger é…ç½®ï¼š</p>
<ol>
<li>åœ¨ IDA çš„<code>Debugger</code>-&gt;<code>Switch Debugger</code>ä¸­é€‰æ‹©<code>Remote iOS Debugger</code></li>
<li>é…ç½® debuggerï¼šæ‰“å¼€<code>Debugger</code>-&gt;<code>Debugger options</code>ï¼Œåœ¨å¼¹å‡ºçš„é¢æ¿ä¸­æ‰“å¼€ <code>Set specific options</code><ol>
<li>è®¾ç½®<code>Symbol path</code>ä¸ºå½“å‰è®¾å¤‡çš„ç¬¦å·æ–‡ä»¶è·¯å¾„ï¼Œä¾‹å¦‚<code>~/Library/Developer/Xcode/iOS DeviceSupport/11.2.2 (15C202)/Symbols/</code></li>
<li>å‹¾é€‰ <code>Launch debugserver automatically</code> </li>
</ol>
</li>
<li>é…ç½® processï¼šæ‰“å¼€<code>Debugger</code>-&gt;<code>Process options</code>ï¼Œè®¾ç½® <code>Application</code> å’Œ<code>Input file</code>ä¸º app äºŒè¿›åˆ¶æ–‡ä»¶åœ¨ iOS è®¾å¤‡ä¸Šçš„è·¯å¾„ï¼Œä¾‹å¦‚<code>/var/containers/Bundle/Application/F366E63D-602B-47D9-B92E-1739A347192B/AppToDebug.app/AppToDebug</code></li>
</ol>
<p><img src="https://upload-images.jianshu.io/upload_images/1865432-ddd13d66ff9f3f50.png?imageMogr2/auto-orient/" alt=""></p>
<p><img src="https://upload-images.jianshu.io/upload_images/1865432-76abb56844484f22.png?imageMogr2/auto-orient/" alt=""></p>
<h3 id="å¯åŠ¨è°ƒè¯•"><a href="#å¯åŠ¨è°ƒè¯•" class="headerlink" title="å¯åŠ¨è°ƒè¯•"></a>å¯åŠ¨è°ƒè¯•</h3><p>é…ç½®å®Œåï¼Œåœ¨ iOS è®¾å¤‡ä¸Š kill æ‰ appï¼Œå°±å¯ä»¥ç”¨ IDA çš„<code>Debugger</code>-&gt;<code>Start Process</code>å¯åŠ¨è¿›ç¨‹è¿›è¡Œè°ƒè¯•ã€‚</p>
<p>å¯åŠ¨å‰å¯ä»¥å…ˆè®¾ç½®æ–­ç‚¹ï¼Œåœ¨æ–­ç‚¹ä¸Šè®¾ç½® traceï¼Œå¯ä»¥ç”¨ä¸åŒé¢œè‰²è¡¨ç¤ºæ§åˆ¶æµçš„è·¯å¾„ã€‚</p>
<p><img src="https://upload-images.jianshu.io/upload_images/1865432-e3aead1e90ed638f.png?imageMogr2/auto-orient/" alt=""></p>
<h3 id="IDA-åŠ¨æ€è°ƒè¯•æ’ä»¶"><a href="#IDA-åŠ¨æ€è°ƒè¯•æ’ä»¶" class="headerlink" title="IDA åŠ¨æ€è°ƒè¯•æ’ä»¶"></a>IDA åŠ¨æ€è°ƒè¯•æ’ä»¶</h3><p>IDA æœ‰äº›å¼€æºæ’ä»¶ç”¨äºå¢å¼ºåŠ¨æ€è°ƒè¯•åŠŸèƒ½ã€‚ä¾‹å¦‚<a href="https://github.com/deresz/funcap" target="_blank" rel="external">funcap</a>å¯ä»¥è®°å½•è¿è¡Œæ—¶çš„å¯„å­˜å™¨ä¿¡æ¯ä½œä¸ºæ³¨é‡Šï¼Œè¾…åŠ©åˆ†æã€‚ä¸è¿‡è¿™ä¸ªå·¥å…·ç°åœ¨åªæ”¯æŒ 32 ä½ã€‚</p>
<p>å…¶ä»–çš„æ’ä»¶ä½ å¯ä»¥è‡ªè¡Œæœç´¢ã€‚ä¸è¿‡èƒ½ç”¨åˆ° iOS ä¸Šçš„åŠ¨æ€è°ƒè¯•æ’ä»¶å¹¶ä¸å¤šã€‚</p>
<h2 id="ç»“å°¾"><a href="#ç»“å°¾" class="headerlink" title="ç»“å°¾"></a>ç»“å°¾</h2><p>åŠ¨æ€è°ƒè¯•çš„æ•´ä¸ªæµç¨‹ä»¥åŠç”¨åˆ°çš„å·¥å…·å¤§éƒ¨åˆ†éƒ½æ€»ç»“åœ¨æ­¤äº†ã€‚è¿˜æœ‰ä¸€ä¸ªå¼ºåŠ›çš„å·¥å…·è¿™é‡Œæ²¡æœ‰è®²è§£ï¼Œå°±æ˜¯ tweak æ’ä»¶ã€‚ç”±äºå†…å®¹æœ‰ç‚¹å¤šï¼Œç•™åˆ°ä¹‹åçš„æ–‡ç« ä¸­å†å±•å¼€ã€‚</p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul>
<li><a href="http://iosre.com/t/topic/8179" target="_blank" rel="external">å…³äºåè°ƒè¯•&amp;ååè°ƒè¯•é‚£äº›äº‹</a></li>
<li><a href="http://bbs.iosre.com/t/topic/9351" target="_blank" rel="external">åè°ƒè¯•ä¸ç»•è¿‡çš„å¥‡æ·«æŠ€å·§</a></li>
<li><a href="http://blog.imjun.net/posts/restore-symbol-of-iOS-app/" target="_blank" rel="external">iOSç¬¦å·è¡¨æ¢å¤&amp;é€†å‘æ”¯ä»˜å®</a></li>
<li><a href="https://zuikyo.github.io/2017/05/04/iOSé€†å‘ï¼šç”¨Xcodeç›´æ¥è°ƒè¯•ç¬¬ä¸‰æ–¹app/">iOSé€†å‘ï¼šç”¨Xcodeç›´æ¥è°ƒè¯•ç¬¬ä¸‰æ–¹app</a></li>
<li><a href="http://lldb.llvm.org/lldb-gdb.html" target="_blank" rel="external">GDB to LLDB Command Map</a></li>
<li><a href="https://objccn.io/issue-19-2/" target="_blank" rel="external">ä¸è°ƒè¯•å™¨å…±èˆ - LLDB çš„åå°”å…¹</a></li>
<li><a href="https://github.com/facebook/chisel" target="_blank" rel="external">chisel</a></li>
<li><a href="https://zuikyo.github.io/2017/05/04/iOSé€†å‘ï¼šåœ¨ä»»æ„appä¸Šå¼€å¯malloc%20stackè¿½è¸ªå†…å­˜æ¥æº/">iOSé€†å‘ï¼šåœ¨ä»»æ„appä¸Šå¼€å¯malloc stackè¿½è¸ªå†…å­˜æ¥æº</a></li>
<li><a href="http://www.cycript.org" target="_blank" rel="external">http://www.cycript.org</a></li>
<li><a href="https://github.com/BishopFox/bfinject" target="_blank" rel="external">bfinject</a></li>
<li><a href="https://www.frida.re/docs" target="_blank" rel="external">Frida å®˜ç½‘</a></li>
<li><a href="https://www.hex-rays.com/products/ida/support/tutorials/ios_debugger_tutorial.pdf" target="_blank" rel="external">Debugging iOS Applications With IDA</a></li>
</ul>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag">#iOS</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/02/16/iOS_reverse_engineering_guide-static_analyzing/" rel="next" title="iOSé€†å‘æŒ‡å—ï¼šé™æ€åˆ†æ">
                <i class="fa fa-chevron-left"></i> iOSé€†å‘æŒ‡å—ï¼šé™æ€åˆ†æ
              </a>
            
          </div>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/07/15/iOS_inrerface_orientation_modularization/" rel="prev" title="æ‰“é€ å®Œå¤‡çš„iOSç»„ä»¶åŒ–æ–¹æ¡ˆï¼šå¦‚ä½•é¢å‘æ¥å£è¿›è¡Œæ¨¡å—è§£è€¦">
                æ‰“é€ å®Œå¤‡çš„iOSç»„ä»¶åŒ–æ–¹æ¡ˆï¼šå¦‚ä½•é¢å‘æ¥å£è¿›è¡Œæ¨¡å—è§£è€¦ <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          

          
  <div class="comments" id="comments">
    
      <div id="gitalk-container"></div>
      <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            æ–‡ç« ç›®å½•
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            ç«™ç‚¹æ¦‚è§ˆ
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.jpg"
               alt="zuik" />
          <p class="site-author-name" itemprop="name">zuik</p>
          <p class="site-description motion-element" itemprop="description">è‡ªå¼ºä¸æ¯ åšå¾·è½½ç‰© zuikxyo@gmail.com https://github.com/Zuikyo https://xiaozhuanlan.com/zuik  https://juejin.im/user/58b78c1dac 502e006bc59b5c</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">15</span>
              <span class="site-state-item-name">æ—¥å¿—</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">9</span>
                <span class="site-state-item-name">åˆ†ç±»</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">1</span>
                <span class="site-state-item-name">æ ‡ç­¾</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

      </section>

      
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">
            
              
            
            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#ç¯å¢ƒæ­å»º"><span class="nav-number">1.</span> <span class="nav-text">ç¯å¢ƒæ­å»º</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#å®‰è£…-openSSH"><span class="nav-number">1.1.</span> <span class="nav-text">å®‰è£… openSSH</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ç”¨-USB-è¿›è¡Œ-SSH-è¿æ¥"><span class="nav-number">1.2.</span> <span class="nav-text">ç”¨ USB è¿›è¡Œ SSH è¿æ¥</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ä¿®æ”¹-debugserver"><span class="nav-number">1.3.</span> <span class="nav-text">ä¿®æ”¹ debugserver</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#è¿æ¥åˆ°æŒ‡å®šè¿›ç¨‹è¿›è¡Œè°ƒè¯•"><span class="nav-number">2.</span> <span class="nav-text">è¿æ¥åˆ°æŒ‡å®šè¿›ç¨‹è¿›è¡Œè°ƒè¯•</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#åè°ƒè¯•"><span class="nav-number">3.</span> <span class="nav-text">åè°ƒè¯•</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å¸¸ç”¨çš„åŠ¨æ€è°ƒè¯•æ–¹æ³•"><span class="nav-number">4.</span> <span class="nav-text">å¸¸ç”¨çš„åŠ¨æ€è°ƒè¯•æ–¹æ³•</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#æ–­ç‚¹"><span class="nav-number">4.1.</span> <span class="nav-text">æ–­ç‚¹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æ ¹æ®äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ–¹æ³•çš„åœ°å€ï¼Œæ‰¾åˆ°éœ€è¦æ–­ç‚¹çš„åœ°å€"><span class="nav-number">4.2.</span> <span class="nav-text">æ ¹æ®äºŒè¿›åˆ¶æ–‡ä»¶ä¸­æ–¹æ³•çš„åœ°å€ï¼Œæ‰¾åˆ°éœ€è¦æ–­ç‚¹çš„åœ°å€</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#åæ±‡ç¼–æŒ‡å®šåœ°å€"><span class="nav-number">4.3.</span> <span class="nav-text">åæ±‡ç¼–æŒ‡å®šåœ°å€</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æŸ¥çœ‹å¯„å­˜å™¨çš„å€¼"><span class="nav-number">4.4.</span> <span class="nav-text">æŸ¥çœ‹å¯„å­˜å™¨çš„å€¼</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æŸ¥çœ‹è°ƒç”¨å †æ ˆ"><span class="nav-number">4.5.</span> <span class="nav-text">æŸ¥çœ‹è°ƒç”¨å †æ ˆ</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æ¢å¤-OC-ç¬¦å·"><span class="nav-number">5.</span> <span class="nav-text">æ¢å¤ OC ç¬¦å·</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ç”¨-Xcode-ç›´æ¥è°ƒè¯•"><span class="nav-number">6.</span> <span class="nav-text">ç”¨ Xcode ç›´æ¥è°ƒè¯•</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#lldbå¸¸ç”¨å‘½ä»¤"><span class="nav-number">7.</span> <span class="nav-text">lldbå¸¸ç”¨å‘½ä»¤</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#æ±‚å€¼ã€æ‰“å°"><span class="nav-number">7.1.</span> <span class="nav-text">æ±‚å€¼ã€æ‰“å°</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æµç¨‹æ§åˆ¶"><span class="nav-number">7.2.</span> <span class="nav-text">æµç¨‹æ§åˆ¶</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æ–­ç‚¹-1"><span class="nav-number">7.3.</span> <span class="nav-text">æ–­ç‚¹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ç›‘æ§åœ°å€"><span class="nav-number">7.4.</span> <span class="nav-text">ç›‘æ§åœ°å€</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å†…å­˜ï¼Œæ ˆä¿¡æ¯"><span class="nav-number">7.5.</span> <span class="nav-text">å†…å­˜ï¼Œæ ˆä¿¡æ¯</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#åæ±‡ç¼–"><span class="nav-number">7.6.</span> <span class="nav-text">åæ±‡ç¼–</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#lldb-å‘½ä»¤æ‰©å±•"><span class="nav-number">8.</span> <span class="nav-text">lldb å‘½ä»¤æ‰©å±•</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å‡ ä¸ªæœ‰ç”¨çš„ç§æœ‰æ–¹æ³•"><span class="nav-number">9.</span> <span class="nav-text">å‡ ä¸ªæœ‰ç”¨çš„ç§æœ‰æ–¹æ³•</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#è‡ªå®šä¹‰-lldb-è„šæœ¬"><span class="nav-number">10.</span> <span class="nav-text">è‡ªå®šä¹‰ lldb è„šæœ¬</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#å‘½ä»¤åˆ«å"><span class="nav-number">10.1.</span> <span class="nav-text">å‘½ä»¤åˆ«å</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ç¼–å†™è‡ªå®šä¹‰è„šæœ¬"><span class="nav-number">10.2.</span> <span class="nav-text">ç¼–å†™è‡ªå®šä¹‰è„šæœ¬</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å¯¼å…¥è‡ªå®šä¹‰è„šæœ¬"><span class="nav-number">10.3.</span> <span class="nav-text">å¯¼å…¥è‡ªå®šä¹‰è„šæœ¬</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å®æˆ˜æ¼”ç»ƒï¼šè¿½è¸ªblockå›è°ƒ"><span class="nav-number">11.</span> <span class="nav-text">å®æˆ˜æ¼”ç»ƒï¼šè¿½è¸ªblockå›è°ƒ</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#blockçš„ç»“æ„"><span class="nav-number">11.1.</span> <span class="nav-text">blockçš„ç»“æ„</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æŸ¥çœ‹invokeæŒ‡é’ˆçš„åœ°å€"><span class="nav-number">11.2.</span> <span class="nav-text">æŸ¥çœ‹invokeæŒ‡é’ˆçš„åœ°å€</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æŸ¥çœ‹blockçš„ç­¾å"><span class="nav-number">11.3.</span> <span class="nav-text">æŸ¥çœ‹blockçš„ç­¾å</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Cycript"><span class="nav-number">12.</span> <span class="nav-text">Cycript</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#å®‰è£…"><span class="nav-number">12.1.</span> <span class="nav-text">å®‰è£…</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ä½¿ç”¨"><span class="nav-number">12.2.</span> <span class="nav-text">ä½¿ç”¨</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#æ–¹æ³•è°ƒç”¨å’Œæ±‚å€¼"><span class="nav-number">12.2.1.</span> <span class="nav-text">æ–¹æ³•è°ƒç”¨å’Œæ±‚å€¼</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#è°ƒç”¨-C-å‡½æ•°"><span class="nav-number">12.2.2.</span> <span class="nav-text">è°ƒç”¨ C å‡½æ•°</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#æ·»åŠ -category"><span class="nav-number">12.2.3.</span> <span class="nav-text">æ·»åŠ  category</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#æŸ¥æ‰¾æŒ‡å®šç±»çš„å¯¹è±¡"><span class="nav-number">12.2.4.</span> <span class="nav-text">æŸ¥æ‰¾æŒ‡å®šç±»çš„å¯¹è±¡</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#hook"><span class="nav-number">12.2.5.</span> <span class="nav-text">hook</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Frida"><span class="nav-number">13.</span> <span class="nav-text">Frida</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#å®‰è£…-1"><span class="nav-number">13.1.</span> <span class="nav-text">å®‰è£…</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ä½¿ç”¨-1"><span class="nav-number">13.2.</span> <span class="nav-text">ä½¿ç”¨</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#åˆ—å‡ºè¿›ç¨‹"><span class="nav-number">13.2.1.</span> <span class="nav-text">åˆ—å‡ºè¿›ç¨‹</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#è°ƒç”¨è¿½è¸ª"><span class="nav-number">13.2.2.</span> <span class="nav-text">è°ƒç”¨è¿½è¸ª</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#è¿æ¥æŒ‡å®šè¿›ç¨‹"><span class="nav-number">13.3.</span> <span class="nav-text">è¿æ¥æŒ‡å®šè¿›ç¨‹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#æ‰§è¡Œè„šæœ¬"><span class="nav-number">13.4.</span> <span class="nav-text">æ‰§è¡Œè„šæœ¬</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ä¸-OC-äº¤äº’"><span class="nav-number">13.4.1.</span> <span class="nav-text">ä¸ OC äº¤äº’</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#è°ƒç”¨-C-å‡½æ•°-1"><span class="nav-number">13.4.2.</span> <span class="nav-text">è°ƒç”¨ C å‡½æ•°</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#hook-1"><span class="nav-number">13.4.3.</span> <span class="nav-text">hook</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#IDA-åŠ¨æ€è°ƒè¯•"><span class="nav-number">14.</span> <span class="nav-text">IDA åŠ¨æ€è°ƒè¯•</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#é…ç½®-debugger"><span class="nav-number">14.1.</span> <span class="nav-text">é…ç½® debugger</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å¯åŠ¨è°ƒè¯•"><span class="nav-number">14.2.</span> <span class="nav-text">å¯åŠ¨è°ƒè¯•</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IDA-åŠ¨æ€è°ƒè¯•æ’ä»¶"><span class="nav-number">14.3.</span> <span class="nav-text">IDA åŠ¨æ€è°ƒè¯•æ’ä»¶</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ç»“å°¾"><span class="nav-number">15.</span> <span class="nav-text">ç»“å°¾</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å‚è€ƒ"><span class="nav-number">16.</span> <span class="nav-text">å‚è€ƒ</span></a></li></ol></div>
            
          </div>
        </section>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">zuik</span>
</div>

<div class="powered-by">
  ç”± <a class="theme-link" href="https://hexo.io">Hexo</a> å¼ºåŠ›é©±åŠ¨
</div>

<div class="theme-info">
  ä¸»é¢˜ -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>

<script>
(function(){
var bp = document.createElement('script');
bp.src = '//zz.bdstatic.com/linksubmit/push.js';
var s = document.getElementsByTagName("script")[0];
s.parentNode.insertBefore(bp, s);
})();
</script>

        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="https://cdn.bootcss.com/jquery/2.1.3/jquery.min.js"></script>

  
  <script type="text/javascript" src="https://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js"></script>

  
  <script type="text/javascript" src="https://cdn.bootcss.com/jquery_lazyload/1.9.7/jquery.lazyload.min.js"></script>

  
  <script type="text/javascript" src="https://cdn.bootcss.com/velocity/1.2.1/velocity.min.js"></script>

  
  <script type="text/javascript" src="https://cdn.bootcss.com/velocity/1.2.1/velocity.ui.min.js"></script>

  
  <script type="text/javascript" src="https://cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.1"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.1"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.1"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.0.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.0.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.1"></script>



  



  




  
    
      <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
      <script type="text/javascript">
        const gitalk = new Gitalk({
          clientID: '348b65b1168d7aa48b08',
          clientSecret: '6a87660b699abe603eac61c471ab5781fd27fc03',
          repo: 'Zuikyo.github.io',
          owner: 'Zuikyo',
          admin: 'Zuikyo'.split(','),
          id: '1525882500000',
          pagerDirection: 'first',
          // facebook-like distraction free mode
          distractionFreeMode: false
        })
        gitalk.render('gitalk-container')
      </script>
    
  

  
  

  

  

  

</body>
</html>
